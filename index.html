<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olympic Hockey Guide 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="flipbook.css">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<body>

<div class="book" id="hockey-book">

    <!-- Page 0: Cover + Introduction -->
    <div class="page">
        <div class="front cover" id="page-p1">
            <img src="cover.png" class="bg-img" style="width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="back panel" id="page-p_intro" style="padding: 25px 25px 15px 25px; background: #fdfdfd; display: flex; flex-direction: column; align-items: center; text-align: center;">
            <h2 style="background: none; color: #111; font-size: 24px; border-bottom: 3px solid #c0392b; margin-bottom: 15px; width: 100%; justify-content: center;">Introduction</h2>
            <div style="font-size: 11.3px; color: #333; line-height: 1.4; text-align: justify; overflow-y: auto; flex-grow: 1;">
                <p style="margin-top: 0; margin-bottom: 10px;"><strong>The Boys Are Back</strong><br>
                After a 12-year wait, the world's greatest stage for hockey is finally back in its true form. With NHL players returning to the Olympic ice for the first time since 2014, the Milano Cortina 2026 Men's Hockey Tournament isn't just another competitionâ€”it's the definitive battle for global supremacy. Follow here from the first puck drop on February 11 to the gold medal game on February 22, as 12 nations battle on Milan's Santagiulia and Rho Arenas.</p>        
                <p style="margin-bottom: 0;"><strong>The Best-on-Best Era</strong><br>
                The storylines are already legendary. For the first time ever, we get to see generational talents like Sidney Crosby and Connor McDavid share the same sweater for Team Canada. Meanwhile, the United States arrives with perhaps their most skilled roster in history, led by Auston Matthews and a powerhouse defense featuring Quinn Hughes.</p>
                <p style="margin-bottom: 0; margin-top: 10px;"><strong>Olympic Hockey Legacy</strong><br>
                Men's hockey debuted at the 1920 Summer Olympics before becoming a Winter Games staple in 1924. Canada dominated early, winning the first four gold medals and has since claimed nine totalâ€”the most of any nation. The U.S. enters with two gold medals (tied for third all-time) and a record eight silvers. Reigning champion Finland seeks to match Canada's 2010-2014 back-to-back feat, defending their first-ever gold won in 2022.</p>
            </div>
            <div style="display: flex; justify-content: center; align-items: center; width: 100%; margin: 15px 0; gap: 20px;">
                <img src="https://upload.wikimedia.org/wikipedia/en/6/60/2026_Winter_Olympics_logo.png?20210922122018" style="height: 60px; width: auto; object-fit: contain;">
                <img src="https://img.olympics.com/images/image/private/t_original_760/f_auto/primary/jbbqfkafamqfxovy0iut" style="height: 60px; width: auto; object-fit: contain;">
                <img src="https://img.olympics.com/images/image/private/t_s_9-16_800/f_auto/primary/aucd9penq1yskqrysm8n" style="height: 60px; width: 45px; object-fit: cover; border-radius: 8px;">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Canadian_Olympic_Committee_logo.svg/960px-Canadian_Olympic_Committee_logo.svg.png?20181224225813" style="height: 60px; width: auto; object-fit: contain;">
            </div>
            <div style="width: 100%; border-top: 1px solid #eee; padding-top: 10px; font-weight: bold; color: #888; font-size: 11px; letter-spacing: 2px;">
                FEBRUARY 11 - 22, 2026
            </div>
        </div>
    </div>

    <!-- Page 1: Daily Buzz + Groups (New Order: 3,4) -->
    <div class="page">
        <div class="front panel" id="page-p5" style="padding: 12px 15px;">
            <h2 style="margin-bottom:8px;">Daily Buzz: Sunday, Feb 15</h2>
            <div style="margin-bottom: 6px;">
                <div style="font-size: 9px; font-weight: 900; color: #888; border-bottom: 2px solid #eee; padding-bottom: 2px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1.5px;">Yesterday's Scores</div>
                <div id="yesterday-buzz-v" style="display: flex; flex-direction: column; gap: 3px;"></div>
            </div>
            <div style="margin-bottom: 6px;">
                <div style="font-size: 9px; font-weight: 900; color: #888; border-bottom: 2px solid #eee; padding-bottom: 2px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1.5px;">Today's Schedule</div>
                <div id="today-buzz-v" style="display: flex; flex-direction: column; gap: 3px;"></div>
            </div>
            <div>
                <div style="font-size: 9px; font-weight: 900; color: #888; border-bottom: 2px solid #eee; padding-bottom: 2px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1.5px;">Tomorrow's Games</div>
                <div id="tomorrow-buzz-v" style="display: flex; flex-direction: column; gap: 3px;"></div>
            </div>
            <div style="margin-top: auto; border-top: 1px dashed #ddd; padding-top: 6px; text-align: center; color: #bbb; font-size: 10px; font-style: italic;">"Gold isn't won on the ice, it's won in the heart."</div>
        </div>
        <div class="back panel" id="page-p7">
            <h2>Group Standings</h2>
            <div class="flex-table-container" id="standings-tables-container"></div>
            <div style="margin-top:auto; font-size:9.5px; border-top:1px solid #ddd; padding-top:4px; color:#000; line-height:1.3;">
                <div>Pts = (W Ã— 3) + (OTW Ã— 2) + (OTL Ã— 1). * or t = OT Result. <strong>Tiebreaker:</strong> H2H record, then GD among tied teams.</div>
            </div>
        </div>
    </div>

    <!-- Page 2: Preliminaries + Seeding (New Order: 5,6) -->
    <div class="page">
        <div class="front panel" id="page-p8" style="padding: 12px 16px 8px 16px;">
            <h2 style="margin-bottom: 6px;">Preliminaries</h2>
            <div class="flex-table-container" style="justify-content: flex-start; overflow: visible;">
                <table id="table-prelims" style="font-size: 13.1px;">
                    <thead><tr><th class="c-grp" style="padding: 3px 8px;">G</th><th class="c-ven" style="padding: 3px 8px;">V</th><th class="c-date" style="padding: 3px 8px;">Date</th><th class="c-time" style="padding: 3px 8px;">ET</th><th class="c-match" style="padding: 3px 8px;">Matchup</th></tr></thead>
                    <tbody id="sched-prelims-v"></tbody>
                </table>
            </div>
            <div style="margin-top:auto; font-size:9.5px; color:#000; border-top:1px solid #ddd; padding-top:4px; display:flex; justify-content:space-between;"><span>S: Santagiulia</span><span>R: Rho Fiera</span></div>
        </div>
        <div class="back panel" id="page-p9">
            <h2>Seeding (1-12)</h2>
            <div style="display:flex; border-bottom:1px solid #000;">
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:5px; color:#000; align-items:center; height:20px; overflow:hidden;">
                        <span style="width:28px; flex-shrink:0; box-sizing:border-box; display:flex; align-items:center; justify-content:center;"></span>
                        <span style="flex:1; box-sizing:border-box; display:flex; align-items:center;">Team Name</span>
                        <span style="width:48px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">Group</span>
                        <span style="width:30px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">GP</span>
                        <span style="width:90px; flex-shrink:0; text-align:center; letter-spacing:0.8px; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">Record</span>
                        <span style="width:35px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">GD</span>
                        <span style="width:35px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">PTS</span>
                        <span style="width:5%; box-sizing:border-box;"></span>
                    </div>
                    <div class="seed-row seed-row-upper" style="gap:0%;"><div class="seed-num" style="width:28px; flex-shrink:0;">1</div><div class="seed-name" style="flex:1;"></div><div class="seed-grp" style="width:48px; flex-shrink:0;"></div><div class="seed-gp" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-record" style="width:90px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div style="width:5%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:0%;"><div class="seed-num" style="width:28px; flex-shrink:0;">2</div><div class="seed-name" style="flex:1;"></div><div class="seed-grp" style="width:48px; flex-shrink:0;"></div><div class="seed-gp" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-record" style="width:90px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div style="width:5%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:0%;"><div class="seed-num" style="width:28px; flex-shrink:0;">3</div><div class="seed-name" style="flex:1;"></div><div class="seed-grp" style="width:48px; flex-shrink:0;"></div><div class="seed-gp" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-record" style="width:90px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div style="width:5%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:0%;"><div class="seed-num" style="width:28px; flex-shrink:0;">4</div><div class="seed-name" style="flex:1;"></div><div class="seed-grp" style="width:48px; flex-shrink:0;"></div><div class="seed-gp" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-record" style="width:90px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div class="seed-stat" style="width:35px; flex-shrink:0;"></div><div style="width:5%;"></div></div>
                </div>
                <div class="vert-label">BYE TO QF</div>
            </div>
            <!-- Qualification: Two columns side by side -->
            <div style="display:flex; gap:15px; margin-top:4px;">
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:3px; padding:0; color:#000;">
                        <span style="width:28px; flex-shrink:0;"></span>
                        <span style="flex:1;">Team Name</span>
                        <span style="width:28px; flex-shrink:0; text-align:center;">GP</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">GD</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">PTS</span>
                    </div>
                    <div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">5</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">6</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">7</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">8</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                    </div>
                </div>
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:3px; padding:0; color:#000;">
                        <span style="width:28px; flex-shrink:0;"></span>
                        <span style="flex:1;">Team Name</span>
                        <span style="width:28px; flex-shrink:0; text-align:center;">GP</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">GD</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">PTS</span>
                    </div>
                    <div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">9</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">10</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">11</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">12</div><div class="seed-name" style="flex:1;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div><div class="seed-stat" style="width:30px; flex-shrink:0;"></div></div>
                    </div>
                </div>
                <div class="vert-label">QUALIFICATION</div>
            </div>
            <!-- Qualification Round Header -->
            <h2 style="margin-top:4px; margin-bottom:4px;">Qualification Round</h2>
            <!-- Qualification Round Games -->
            <div>
                <table style="width:100%; border-collapse:collapse; font-size:12px;">
                    <thead>
                        <tr style="display:none;">
                            <th class="c-grp" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:18px;">G</th>
                            <th class="c-ven" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:18px;">V</th>
                            <th class="c-date" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:68px;">Date</th>
                            <th class="c-time" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:42px;">ET</th>
                            <th class="c-flag" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:22px;"></th>
                            <th class="c-match" style="padding:3px 10px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd;">Matchup</th>
                            <th class="c-flag" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:22px;"></th>
                        </tr>
                    </thead>
                    <tbody id="qual-games-v"></tbody>
                </table>
            </div>
            <!-- Reseed section for Quarterfinals -->
            <div style="margin-top:auto; margin-bottom:6px; padding:8px; background:#f0f0f0; border:1px solid #ccc; border-radius:3px;">
                <div style="font-size:10px; font-weight:900; color:#333; margin-bottom:5px; text-transform:uppercase;">Reseed for Quarterfinals</div>
                <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:4px; font-size:10px;">
                    <div class="seed-row" style="margin:0; gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">1</div><div class="seed-name" style="flex:1;"></div></div>
                    <div class="seed-row" style="margin:0; gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">2</div><div class="seed-name" style="flex:1;"></div></div>
                    <div class="seed-row" style="margin:0; gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">3</div><div class="seed-name" style="flex:1;"></div></div>
                    <div class="seed-row" style="margin:0; gap:0;"><div class="seed-num" style="width:28px; flex-shrink:0;">4</div><div class="seed-name" style="flex:1;"></div></div>
                </div>
            </div>
            <div style="font-size:9.5px; color:#000; border-top:1px solid #ddd; padding-top:4px; line-height:1.3;">
                <div style="margin-bottom:3px;"><strong>Seeding:</strong> Group winners â†’ Seeds 1-3. Best 2nd place â†’ Seed 4. Then by: Pts > GD > GF > IIHF Ranking.</div>
                <div>Semi-Finals: Highest seed plays lowest, 2nd-highest plays 3rd-highest.</div>
            </div>
        </div>
    </div>

    <!-- Page 3: Knockout + Global Contenders (New Order: 7,8) -->
    <div class="page">
        <div class="front panel" id="page-p10" style="padding-right: 10px;">
            <h2 style="margin-top:0;">Knockout Bracket</h2>
            <div class="flex-table-container">
                <table id="table-ko" style="font-size: 12px;">
                    <tbody id="sched-ko-v"></tbody>
                </table>
            </div>
            <!-- Podium Footer -->
            <div style="margin-top:auto; padding:10px; background:#f8f8f8; border:1px solid #ddd; border-radius:4px;">
                <div style="display:flex; align-items:flex-end; justify-content:center; gap:15px; height:85px;">
                    <!-- Silver (2nd) -->
                    <div style="display:flex; flex-direction:column; align-items:center; width:90px;">
                        <div id="podium-silver" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #999; border-radius:3px; min-width:70px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #C0C0C0 0%, #A8A8A8 100%); width:100%; height:50px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #999;">
                            <span style="font-size:20px;">ðŸ¥ˆ</span>
                        </div>
                    </div>
                    <!-- Gold (1st - tallest) -->
                    <div style="display:flex; flex-direction:column; align-items:center; width:100px;">
                        <div id="podium-gold" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #B8860B; border-radius:3px; min-width:80px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #FFD700 0%, #DAA520 100%); width:100%; height:65px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #B8860B;">
                            <span style="font-size:24px;">ðŸ¥‡</span>
                        </div>
                    </div>
                    <!-- Bronze (3rd - shortest) -->
                    <div style="display:flex; flex-direction:column; align-items:center; width:90px;">
                        <div id="podium-bronze" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #8B4513; border-radius:3px; min-width:70px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #CD7F32 0%, #8B4513 100%); width:100%; height:40px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #8B4513;">
                            <span style="font-size:18px;">ðŸ¥‰</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="back panel" id="page-p_new8" style="padding: 15px; background: #fdfdfd;">
            <h2>Global Contenders</h2>
            <div style="margin-top: 2px; display: grid; grid-template-columns: 1fr 1fr; gap: 6px 12px; width: calc(100% - 10px); max-width: none; margin-left: 0; margin-right: auto; justify-items: start;">
              <div class="star-card" style="margin:0; display:flex; align-items:center; gap:4px; font-size:13px; padding:2px 4px 2px 0;">
                <img src="https://flagcdn.com/w80/ca.png" style="width:38.5px; height:25px; border:1px solid #bbb; margin-right:2px; margin-left:0;">
                <div style="display:flex; flex-direction:column; justify-content:space-between; min-width:0; padding-left:0;">
                  <div style="display:flex; align-items:flex-start; gap:6px;">
                    <span style="font-weight:900; color:#222; font-size:14px;">Canada</span>
                    <span style="flex:1; border-bottom:2px solid #bbb; height:0; margin-bottom:4px; margin-left:4px;"></span>
                  </div>
                  <div style="margin-top:3px; color:#222; font-size:12px; font-weight:500; white-space:nowrap;">McDavid, Crosby, MacKinnon</div>
                </div>
              </div>

              <div class="star-card" style="margin:0; display:flex; align-items:center; gap:4px; font-size:13px; padding:2px 4px 2px 0;">
                <img src="https://flagcdn.com/w80/us.png" style="width:38.5px; height:25px; border:1px solid #bbb; margin-right:2px; margin-left:0;">
                <div style="display:flex; flex-direction:column; justify-content:space-between; min-width:0; padding-left:0;">
                  <div style="display:flex; align-items:flex-start; gap:6px;">
                    <span style="font-weight:900; color:#222; font-size:14px;">USA</span>
                    <span style="flex:1; border-bottom:2px solid #bbb; height:0; margin-bottom:4px; margin-left:4px;"></span>
                  </div>
                  <div style="margin-top:3px; color:#222; font-size:12px; font-weight:500; white-space:nowrap;">Matthews, Tkachuk, Hughes</div>
                </div>
              </div>
            </div>
            
            <!-- Stats Section -->
            <div style="margin-top: 8px;">
              <div style="font-size: 14px; font-weight: 900; color: #c0392b; margin-bottom: 4px; text-transform: uppercase; letter-spacing:1px;">Top 5 Points</div>
              <table style="width:100%; font-size:11px; border-collapse:separate; border-spacing:0 2px; margin-bottom:8px; table-layout:fixed;">
                <thead style="background:#eee;">
                  <tr>
                    <th style="padding:2px; text-align:center; width:4%; font-size:10px;">#</th>
                    <th style="padding:2px 0 2px 3px; text-align:left; width:44%; font-size:10px;">Player</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">Team</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">GP</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">G</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">A</th>
                    <th style="padding:2px; text-align:center; width:11%; font-size:10px;">PTS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Connor McDavid
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">7</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">9</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Macklin Celebrini
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/sk.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Juraj Slafkovsky
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">SVK</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Sidney Crosby
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">5</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Nathan MacKinnon
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">5</td>
                  </tr>
                </tbody>
              </table>

              <div style="font-size: 14px; font-weight: 900; color: #2980b9; margin-bottom: 4px; text-transform: uppercase; letter-spacing:1px;">Top 5 Goalies</div>
              <table style="width:100%; font-size:11px; border-collapse:separate; border-spacing:0 2px; table-layout:fixed;">
                <thead style="background:#eee;">
                  <tr>
                    <th style="padding:2px; text-align:center; width:4%; font-size:10px;">#</th>
                    <th style="padding:2px 0 2px 3px; text-align:left; width:44%; font-size:10px;">Player</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">Team</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">GP</th>
                    <th style="padding:2px; text-align:center; width:8%; font-size:10px;">W</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">GAA</th>
                    <th style="padding:2px; text-align:center; width:11%; font-size:10px;">SV%</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Logan Thompson
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.960</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Jordan Binnington
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.950</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ch.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Leonardo Genoni
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">SUI</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.48</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.949</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/fi.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Juuse Saros
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">FIN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.34</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.946</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">5</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/us.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Connor Hellebuyck
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">USA</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.944</td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div style="margin-top: auto; font-size: 12px; line-height: 1.4; color: #555; background: #fff; padding: 10px; border: 1px solid #eee;">
                <div style="margin-bottom:6px;"><b>The Verdict:</b> Milan 2026 marks the first "Best-on-Best" tournament in over a decade. While Canada remains the favorite, the gap has closed, with the USA and Sweden bringing perhaps their fastest rosters in Olympic history.</div>
                <div style="font-size:10px; color:#666;">Official game statistics can be found <a href="https://www.iihf.com/en/events/2026/olympic-m/tournamentinfo/officialdocuments" target="_blank" style="color:#2980b9; text-decoration:underline;">here</a>.</div>
            </div>
        </div>
    </div>

    <!-- Page 4: Rules + Canada Pic (New Order: 9,10) -->
    <div class="page">
        <div class="front panel" id="page-p_rules" style="padding: 15px; background: #fff;">
            <h2 style="margin-bottom: 8px;">Tournament Rules</h2>
            <div class="rules-main-list">
                <div class="rule-block">
                    <b>Fighting ejections</b>
                    <p>Automatic game misconduct and ejection. The IIHF Disciplinary Committee reviews all incidents for additional suspension.</p>
                </div>
                <div class="rule-block">
                    <b>The "Oshie" Shootout</b>
                    <p>Five initial shooters. After round five, a coach can choose the same player to shoot repeatedly as often as they desire.</p>
                </div>
                <div class="rule-block">
                    <b>Strict Crease Rule</b>
                    <p>If an attacker enters the crease even without contact, the referee may call a whistle and move the faceoff outside the zone.</p>
                </div>
                <div class="rule-block">
                    <b>Checks to the Head</b>
                    <p>In international play, checks to the head can be called as major penalties or game misconducts if the referee deems the play reckless.</p>
                </div>
            </div>
            <div style="display: flex; gap: 6px; margin-top: 6px;">
                <div class="ot-container" style="flex: 1;">
                    <h3>Point System</h3>
                    <p style="font-size: 10px; margin: 0; color: #222;">3 points for regulation win, 2 for OT/SO win, 1 for OT/SO loss, 0 for regulation loss.</p>
                </div>
                <div class="ot-container" style="flex: 1;">
                    <h3>Rosters</h3>
                    <p style="font-size: 10px; margin: 0; color: #222;">22-man active game rosters (20 skaters, 2 goalies). Lineups due 60m before puck drop.</p>
                </div>
                <div class="ot-container" style="flex: 1;">
                    <h3>Rink Dimensions</h3>
                    <p style="font-size: 10px; margin: 0 0 2px 0; color: #222;"><b style="font-size: 10.5px;">NHL:</b> 200 L Ã— 85 W ft.</p>
                    <p style="font-size: 10px; margin: 0 0 2px 0; color: #222;"><b style="font-size: 10.5px;">IIHF:</b> 197 L Ã— 98.5 W ft.</p>
                    <p style="font-size: 10px; margin: 0; color: #222;"><b style="font-size: 10.5px;">OLY:</b> 196.85 L Ã— 85.3 W ft.</p>
                </div>
            </div>
            <div style="display: flex; gap: 6px; margin-top: 6px;">
                <div class="ot-container" style="flex: 0 0 55%;">
                    <h3>Overtime Formats</h3>
                    <div class="ot-sub-item"><b>Preliminary Round</b><p>5-minute 3-on-3 sudden death followed by a shootout.</p></div>
                    <div class="ot-sub-item"><b>Quarter/Semifinals</b><p>10-minute 3-on-3 sudden death followed by a shootout.</p></div>
                    <div class="ot-sub-item"><b>Gold Medal Game (No shootouts)</b><p>Unlimited 20-minute 3-on-3 periods until a winner scores.</p></div>
                </div>
                <div class="ot-container" style="flex: 0 0 45%;">
                    <h3>Equipment</h3>
                    <div class="ot-sub-item"><b>Goalie Mask Designs</b><p>Need pre-approval from tournament officials.</p></div>
                    <div class="ot-sub-item"><b>Neck Guards</b><p>Mandatory for all players on the ice.</p></div>
                    <div class="ot-sub-item"><b>Sticks</b><p>Must be on market within last 6 months.</p></div>
                </div>
            </div>
            <div style="margin-top:auto; font-size:9.5px; color:#000; border-top:1px solid #ddd; padding-top:4px; line-height:1.3;">
                Complete IIHF rulebook can be found <a href="https://blob.iihf.com/iihf-media/iihfmvc/media/contentimages/3_the_iihf/2025-26_iihf_rulebook_22122025-v1.pdf" target="_blank" style="color:#2980b9; text-decoration:underline;">here</a>.
            </div>
        </div>
        <div class="back panel" id="page-p6" style="padding:0; background:#000;">
            <img src="https://i0.wp.com/www.rawcharge.com/wp-content/uploads/sites/5/2025/12/team-canada-roster.jpg?resize=819%2C1024&ssl=1" style="width:100%; height:100%; object-fit:fill;">
        </div>
    </div>

    <!-- Page 5: Tina + Santagiulia (New Order: 11,12) -->
    <div class="page">
        <div class="front panel tina-layout" id="page-p2">
            <div class="tina-img-zone">
                <img src="https://i.postimg.cc/HnxSPprz/miss.png" alt="Tina Mascot">
            </div>
            <div class="tina-title-banner">
                <span class="tina-title-main">Meet Tina</span>
                <span class="tina-title-pipe">|</span>
                <span class="tina-title-sub">The Official Mascot</span>
            </div>
            <div class="tina-text-box">
                <div class="venue-desc" style="color:#444;">
                    Born in the Italian peaks and refined by the city, Tina is a dreamer on a mission. Explorer, guardian of nature, and believer that big dreams change the world. She knows that differences are an asset and respect is fundamental to growing up. From the snow-capped summits of Cortina to the urban sprawl of Milano, she is the creative spirit of the Games. Nature remains her true home, and she does everything in her power to protect it.
                </div>
            </div>
        </div>
        <div class="back panel page-layout-full" id="page-p3">
            <img src="https://c.imggu.com/i/2026/02/12/7Fp1Y.png" class="bg-img" alt="Santagiulia Collage">
            <div class="venue-header-overlay">
                <div class="venue-title-perf"><b>Santagiulia</b><div class="divider"></div>Arena Italia</div>
                <div class="venue-architect-perf">Architect: David Chipperfield</div>
            </div>
            <div class="text-bottom-overlay pos-giulia">
                <p class="desc-text-perf" style="font-size: 13px; line-height: 1.5;">The Santagiulia Arena is the high-tech cathedral for the gold medal quest. Its shimmering metallic rings echo the spiraling ramps of the legendary San Siro stadium, glowing with LED strips at night. Inside, the surface is crafted by legendary ice man Don Moffatt, providing a stage for 16,000 fans to witness the crowning of Olympic champions.</p>
            </div>
        </div>
    </div>

    <!-- Page 6: Rho Fiera + History (New Order: 13,14) -->
    <div class="page">
        <div class="front panel page-layout-full" id="page-p4">
            <img src="https://b.imggu.com/i/2026/02/12/7FWCV.png" class="bg-img" alt="Rho Fiera Collage">
            <div class="venue-header-overlay align-right">
                <div class="venue-title-perf"><b>Rho Fiera</b><div class="divider"></div>Total Ice Park</div>
                <div class="venue-architect-perf">Architect: Massimiliano Fuksas</div>
            </div>
            <div class="text-bottom-overlay pos-rho">
                <p class="desc-text-perf" style="font-size: 13px; line-height: 1.5;">The Milano Ice Park is where the beauty of the sport meets the beast of architecture. The campus features a Speed Skating Stadium for 7,500 fans and a secondary Hockey Arena for 6,000. Under its sweeping glass roof, this landmark facility creates a high-performance environment where elegance and power collide.</p>
            </div>
        </div>
        <div class="back panel" id="page-p11">
            <h2>Olympic History</h2>
            <table class="medals-table">
                <thead><tr><th>Year</th><th>ðŸ¥‡ Gold</th><th>ðŸ¥ˆ Silver</th><th>ðŸ¥‰ Bronze</th></tr></thead>
                <tbody id="history-v"></tbody>
            </table>
            <div style="text-align: center; font-size: 10px; color: #333; line-height: 1.4; margin-top: 0; margin-bottom: 0; padding: 5px 7px; background: #fafafa; border: 1px solid #eee; border-radius: 2px;">
                List reflects when NHL players join Olympics circa 1998 | <span style="color: #c0392b;">*</span> NHL opts out 2018 & 2022
            </div>
            <div style="margin: 4px auto 0; width: 100%; padding: 8px; background: #fff; border-radius: 2px; box-sizing: border-box; overflow: hidden;">
              <img src="https://i.postimg.cc/xT5YsbQy/wq.png" style="width: calc(100% - 16px); display: block; margin: 0 auto;">
              <div style="text-align: center; font-size: 11px; color: #555; margin: 0 2px 9px 2px; padding: 4px 2px; font-style: italic; line-height:1.2; background: #f9f9f9; border-radius: 4px;">Dominik HaÅ¡ek holds his gold medal after shutting out Russia 1-0 in 1998. Nagano, Japan.</div>
            </div>
        </div>
    </div>

    <!-- Page 7: Notes + Back Cover -->
    <div class="page">
        <div class="front panel" id="page-p_outro" style="padding: 20px; background: #fff;">
            <h2 style="background: var(--header-bg); color: #fff; padding: 5px 10px; margin: -10px -10px 10px -10px;">Tournament Notes</h2>
            <div style="margin-top: 10px; font-size: 13px; color: #333; line-height: 1.6;">
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #2980b9;">
                    <strong>Group B 3-Way Tie (6 pts each):</strong><br>
                    Slovakia, Finland, Sweden tied at 6 pts. H2H circular (each beat one other). GD among tied: SVK +1, FIN 0, SWE -1. Result: 1. Slovakia, 2. Finland, 3. Sweden.
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #c0392b;">
                    <strong>Suspensions:</strong><br>
                    Italy's C. Digiacinto suspended 1 game (illegal check to head, Game #8 vs SVK, 2/13 2nd period, IIHF Rule 48).
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #27ae60;">
                    <strong>Seeding Criteria:</strong><br>
                    1. Group position 2. Points 3. GD 4. GF 5. IIHF Ranking. Group tiebreaker: H2H first, then GD among tied.
                </div>
            </div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="margin-top: auto; font-size: 11px; color: #555; border-top: 1px solid #ddd; padding-top: 6px; background: #fafafa;">
                <strong>IIHF Resources:</strong><br>
                <a href="https://www.iihf.com/en/events/2026/olympic-m/tournamentinfo/68589/tournament_format" target="_blank" style="color:#2980b9;">Tournament Format</a> |
                <a href="https://blob.iihf.com/iihf-media/iihfmvc/media/contentimages/3_the_iihf/2025-26_iihf_rulebook_22122025-v1.pdf" target="_blank" style="color:#2980b9;">IIHF Rulebook (PDF)</a> |
                <a href="https://www.iihf.com/en/events/2026/olympic-m/gamedocs" target="_blank" style="color:#2980b9;">Official Game Documents</a>
            </div>
        </div>
        <div class="back cover" id="page-p12">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/IJshockeyteam_tijdens_Olympische_Winterspelen%2C_SFA022000505.jpg/1280px-IJshockeyteam_tijdens_Olympische_Winterspelen%2C_SFA022000505.jpg" class="bg-img" alt="Vintage hockey" style="filter: grayscale(100%) contrast(1.2);">
            <div class="back-overlay">
                <svg class="oly-logo" style="margin-top: 50px; filter: brightness(0);" viewBox="0 0 100 50">
                    <circle cx="20" cy="18" r="14" stroke="black" fill="none" stroke-width="3"></circle>
                    <circle cx="50" cy="18" r="14" stroke="black" fill="none" stroke-width="3"></circle>
                    <circle cx="80" cy="18" r="14" stroke="black" fill="none" stroke-width="3"></circle>
                    <circle cx="35" cy="32" r="14" stroke="black" fill="none" stroke-width="3"></circle>
                    <circle cx="65" cy="32" r="14" stroke="black" fill="none" stroke-width="3"></circle>
                </svg>
                <div style="margin-top: auto; font-size: 10px; color: #000; font-weight: bold; padding-bottom: 15px;">Â© 2026 ONO.flips</div>
            </div>
        </div>
    </div>

</div>

<!-- Navigation Buttons -->
<div class="page-display" id="page-display">COVER</div>
<button class="push--prev" onclick="bookPrev()" title="Previous"></button>
<button class="push--next" onclick="bookNext()" title="Next"></button>
<button class="push--menu" onclick="toggleMenu()" id="menu-toggle" title="Menu"></button>
<div class="menu-dropdown" id="menu-dropdown">
    <button class="menu-item" onclick="toggleFullscreen(); closeMenu();">â›¶ Fullscreen</button>
    <button class="menu-item" onclick="resetBook(); closeMenu();">âŸ² Reset</button>
    <button class="menu-item" onclick="bookGoTo(0); closeMenu();">â® First</button>
    <button class="menu-item" onclick="bookGoTo(99); closeMenu();">â­ Last</button>
</div>

<!-- Page turn sound -->
<audio id="pageTurn" preload="auto" src="PageFlip3.wav"></audio>

<script>
// Apply initial transform
window.addEventListener('DOMContentLoaded', () => {
    applyTransform();
});

function applyTransform() {
    const book = document.getElementById('hockey-book');
    if (book) {
        let baseTransform;
        const c = parseInt(book.style.getPropertyValue('--c') || '0');
        const totalPages = book.querySelectorAll('.page').length;
        
        if (c === 0) {
            // Front cover: page extends RIGHT of spine, shift left to center
            baseTransform = 'translateX(calc(var(--panel-width) / -2))';
        } else if (c >= totalPages) {
            // Back cover: page extends LEFT of spine, shift right to center
            baseTransform = 'translateX(calc(var(--panel-width) / 2))';
        } else {
            // Open book: spread visible, spine at center
            baseTransform = 'translateX(0)';
        }
        book.style.transform = baseTransform;
    }
}

// Menu toggle
window.toggleMenu = () => {
    const dropdown = document.getElementById('menu-dropdown');
    const toggle = document.getElementById('menu-toggle');
    if (dropdown && toggle) {
        dropdown.classList.toggle('show');
        toggle.classList.toggle('active');
    }
};

window.closeMenu = () => {
    const dropdown = document.getElementById('menu-dropdown');
    const toggle = document.getElementById('menu-toggle');
    if (dropdown && toggle) {
        dropdown.classList.remove('show');
        toggle.classList.remove('active');
    }
};



// Fullscreen toggle
window.toggleFullscreen = () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(() => {});
    } else {
        document.exitFullscreen().catch(() => {});
    }
};

document.addEventListener('fullscreenchange', () => {
    applyTransform();
});

// Reset to first page
window.resetBook = () => {
    if (window.bookGoTo) window.bookGoTo(0);
    applyTransform();
};

// Prevent image dragging
document.addEventListener('dragstart', (e) => {
    if (e.target.tagName === 'IMG') {
        e.preventDefault();
    }
});

// Page flip on edge click
document.addEventListener('click', (e) => {
    const panel = e.target.closest('.front, .back');
    if (panel) {
        const rect = panel.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const edgeWidth = rect.width * 0.2;
        if (x < edgeWidth && window.bookPrev) {
            window.bookPrev();
        } else if (x > rect.width - edgeWidth && window.bookNext) {
            window.bookNext();
        }
    }
});

// Hover effect on edges
document.addEventListener('mousemove', (e) => {
    const panel = e.target.closest('.front, .back');
    document.querySelectorAll('.page-flip-zone').forEach(z => {
        z.style.background = '';
        z.style.boxShadow = '';
    });
    
    if (panel) {
        const rect = panel.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const edgeWidth = rect.width * 0.2;
        const isFront = panel.classList.contains('front');
        const isBack = panel.classList.contains('back');
        
        if (isFront && x > rect.width - edgeWidth) {
            const zone = panel.querySelector('.page-flip-right');
            if (zone) {
                zone.style.background = 'linear-gradient(to left, rgba(255, 200, 50, 0.5), transparent)';
                zone.style.boxShadow = 'inset -15px 0 30px -5px rgba(0,0,0,0.4)';
                document.body.style.cursor = 'pointer';
            }
        } else if (isBack && x < edgeWidth) {
            const zone = panel.querySelector('.page-flip-left');
            if (zone) {
                zone.style.background = 'linear-gradient(to right, rgba(255, 200, 50, 0.5), transparent)';
                zone.style.boxShadow = 'inset 15px 0 30px -5px rgba(0,0,0,0.4)';
                document.body.style.cursor = 'pointer';
            }
        } else {
            document.body.style.cursor = '';
        }
    } else {
        document.body.style.cursor = '';
    }
});

// Flipbook engine
const flipBook = (elBook) => {
    const pages = Array.from(elBook.querySelectorAll(".page"));
    let current = 0;

    const updatePageDisplay = () => {
        const display = document.getElementById('page-display');
        if (!display) return;
        if (current === 0) {
            display.textContent = 'COVER';
        } else if (current >= pages.length) {
            display.textContent = 'BACK';
        } else {
            const leftPage = current * 2;
            const rightPage = leftPage + 1;
            display.textContent = leftPage + ' | ' + rightPage;
        }
    };

    const playPageSound = () => {
        const audio = document.getElementById('pageTurn');
        if (audio) {
            audio.currentTime = 0;
            audio.volume = 0.6;
            audio.play().catch(() => {});
        }
    };

    const setCurrent = (c) => {
        current = Math.max(0, Math.min(c, pages.length));
        elBook.style.setProperty("--c", current);
        applyTransform();
        updatePageDisplay();
        playPageSound();
    };

    const createZone = (side) => {
        const zone = document.createElement('div');
        zone.className = `page-flip-zone page-flip-${side}`;
        return zone;
    };

    pages.forEach((page, idx) => {
        page.style.setProperty("--i", idx);
        
        // Add visual hover zones on edges (click handled by mouseup)
        const frontPanel = page.querySelector('.front');
        if (frontPanel) {
            frontPanel.style.position = 'relative';
            frontPanel.appendChild(createZone('right'));
        }
        
        const backPanel = page.querySelector('.back');
        if (backPanel) {
            backPanel.style.position = 'relative';
            backPanel.appendChild(createZone('left'));
        }
    });

    setCurrent(0);

    // Expose for buttons
    window.bookNext = () => setCurrent(current + 1);
    window.bookPrev = () => setCurrent(current - 1);
    window.bookGoTo = (c) => setCurrent(c);
};

document.querySelectorAll(".book").forEach(flipBook);

// Inline data (fallback if fetch fails - works with file:// protocol)
window.HockeyData = {
    "flagMap": {
        "Canada": "ca", "Czechia": "cz", "Switzerland": "ch", "France": "fr",
        "Finland": "fi", "Sweden": "se", "Slovakia": "sk", "Italy": "it",
        "USA": "us", "Germany": "de", "Latvia": "lv", "Denmark": "dk"
    },
    "storedScores": {
        "p1-h": "4", "p1-a": "1", "p2-h": "5", "p2-a": "2",
        "p3-h": "4", "p3-a": "0", "p4-a": "5", "p4-h": "0",
        "p5-a": "5", "p5-h": "1", "p6-h": "3", "p6-a": "1",
        "p7-h": "4", "p7-a": "1", "p8-h": "2", "p8-a": "3",
        "p9-h": "3", "p9-a": "6", "p10-h": "5", "p10-a": "1",
        "p11-h": "5", "p11-a": "3", "p12-h": "3", "p12-a": "4",
        "p13-h": "11", "p13-a": "0", "p14-h": "6", "p14-a": "3",
        "p15-h": "4", "p15-a": "3*", "p16-h": "10", "p16-a": "2"
    },
    "storedESPNStats": {
        "scorers": [
            {"rank": "1.", "name": "Connor McDavid", "team": "CAN", "gp": "3", "goals": "2", "assists": "7", "points": "9"},
            {"rank": "2.", "name": "Macklin Celebrini", "team": "CAN", "gp": "3", "goals": "4", "assists": "2", "points": "6"},
            {"rank": "3.", "name": "Juraj Slafkovsky", "team": "SVK", "gp": "3", "goals": "3", "assists": "3", "points": "6"},
            {"rank": "4.", "name": "Sidney Crosby", "team": "CAN", "gp": "3", "goals": "2", "assists": "4", "points": "6"},
            {"rank": "5.", "name": "Nathan MacKinnon", "team": "CAN", "gp": "3", "goals": "2", "assists": "3", "points": "5"}
        ],
        "goalies": [
            {"rank": "1.", "name": "Logan Thompson", "team": "CAN", "gp": "1", "wins": "1", "gaa": "1.00", "svp": ".960"},
            {"rank": "2.", "name": "Jordan Binnington", "team": "CAN", "gp": "2", "wins": "2", "gaa": "1.00", "svp": ".950"},
            {"rank": "3.", "name": "Leonardo Genoni", "team": "SUI", "gp": "2", "wins": "2", "gaa": "1.48", "svp": ".949"},
            {"rank": "4.", "name": "Juuse Saros", "team": "FIN", "gp": "3", "wins": "2", "gaa": "1.34", "svp": ".946"},
            {"rank": "5.", "name": "Connor Hellebuyck", "team": "USA", "gp": "1", "wins": "1", "gaa": "1.00", "svp": ".944"}
        ],
        "lastFetch": "2026-02-14T22:30:16.228Z"
    },
    "prelims": [
        { "id": "p1", "g": "B", "d": "Wed Feb 11", "t": "10:40a", "h": "Slovakia", "a": "Finland", "v": "R" },
        { "id": "p2", "g": "B", "d": "Wed Feb 11", "t": "03:10p", "h": "Sweden", "a": "Italy", "v": "S" },
        { "id": "p3", "g": "A", "d": "Thu Feb 12", "t": "06:10a", "h": "Switzerland", "a": "France", "v": "R" },
        { "id": "p4", "g": "A", "d": "Thu Feb 12", "t": "10:40a", "h": "Czechia", "a": "Canada", "v": "S" },
        { "id": "p5", "g": "C", "d": "Thu Feb 12", "t": "03:10p", "h": "Latvia", "a": "USA", "v": "R" },
        { "id": "p6", "g": "C", "d": "Thu Feb 12", "t": "03:10p", "h": "Germany", "a": "Denmark", "v": "R" },
        { "id": "p7", "g": "B", "d": "Fri Feb 13", "t": "06:10a", "h": "Finland", "a": "Sweden", "v": "S" },
        { "id": "p8", "g": "B", "d": "Fri Feb 13", "t": "06:10a", "h": "Italy", "a": "Slovakia", "v": "R" },
        { "id": "p9", "g": "A", "d": "Fri Feb 13", "t": "10:40a", "h": "France", "a": "Czechia", "v": "R" },
        { "id": "p10", "g": "A", "d": "Fri Feb 13", "t": "03:10p", "h": "Canada", "a": "Switzerland", "v": "S" },
        { "id": "p11", "g": "B", "d": "Sat Feb 14", "t": "06:10a", "h": "Sweden", "a": "Slovakia", "v": "R" },
        { "id": "p12", "g": "C", "d": "Sat Feb 14", "t": "06:10a", "h": "Germany", "a": "Latvia", "v": "S" },
        { "id": "p13", "g": "B", "d": "Sat Feb 14", "t": "10:40a", "h": "Finland", "a": "Italy", "v": "R" },
        { "id": "p14", "g": "C", "d": "Sat Feb 14", "t": "03:10p", "h": "USA", "a": "Denmark", "v": "S" },
        { "id": "p15", "g": "A", "d": "Sun Feb 15", "t": "06:10a", "h": "Switzerland", "a": "Czechia", "v": "S" },
        { "id": "p16", "g": "A", "d": "Sun Feb 15", "t": "10:40a", "h": "Canada", "a": "France", "v": "R" },
        { "id": "p17", "g": "C", "d": "Sun Feb 15", "t": "01:10p", "h": "Denmark", "a": "Latvia", "v": "R" },
        { "id": "p18", "g": "C", "d": "Sun Feb 15", "t": "03:10p", "h": "USA", "a": "Germany", "v": "S" }
    ],
    "knockouts": [
        { "header": "QUALIFICATION ROUND" },
        { "id": "k1", "g": "Q", "d": "Tue Feb 17", "t": "06:10a", "h": "Germany", "a": "Denmark", "v": "R" },
        { "id": "k2", "g": "Q", "d": "Tue Feb 17", "t": "10:40a", "h": "Sweden", "a": "Italy", "v": "S" },
        { "id": "k3", "g": "Q", "d": "Tue Feb 17", "t": "12:10p", "h": "Switzerland", "a": "France", "v": "R" },
        { "id": "k4", "g": "Q", "d": "Tue Feb 17", "t": "03:10p", "h": "Czechia", "a": "Latvia", "v": "S" },
        { "header": "QUARTERFINALS" },
        { "id": "k5", "g": "QF", "d": "Wed Feb 18", "t": "10:40a", "h": "Canada", "a": "Reseed 4", "v": "S" },
        { "id": "k6", "g": "QF", "d": "Wed Feb 18", "t": "10:40a", "h": "USA", "a": "Reseed 3", "v": "R" },
        { "id": "k7", "g": "QF", "d": "Wed Feb 18", "t": "03:10p", "h": "Slovakia", "a": "Reseed 2", "v": "S" },
        { "id": "k8", "g": "QF", "d": "Wed Feb 18", "t": "03:10p", "h": "Finland", "a": "Reseed 1", "v": "R" },
        { "header": "SEMIFINALS" },
        { "id": "k9", "g": "SF", "d": "Fri Feb 20", "t": "10:40a", "h": "Win QF", "a": "Win QF", "v": "S" },
        { "id": "k10", "g": "SF", "d": "Fri Feb 20", "t": "03:10p", "h": "Win QF", "a": "Win QF", "v": "S" },
        { "header": "MEDAL GAMES" },
        { "id": "k11", "g": "ðŸ¥‰", "d": "Sat Feb 21", "t": "02:40p", "h": "Lose SF1", "a": "Lose SF2", "v": "S" },
        { "id": "k12", "g": "ðŸ¥‡ðŸ¥ˆ", "d": "Sun Feb 22", "t": "08:10a", "h": "Win SF1", "a": "Win SF2", "v": "S" }
    ],
    "historyData": [
        ["2022", "fi", "FIN", "ru", "ROC", "sk", "SVK"],
        ["2018", "ru", "OAR", "de", "GER", "ca", "CAN"],
        ["2014", "ca", "CAN", "se", "SWE", "fi", "FIN"],
        ["2010", "ca", "CAN", "us", "USA", "fi", "FIN"],
        ["2006", "se", "SWE", "fi", "FIN", "cz", "CZE"],
        ["2002", "ca", "CAN", "us", "USA", "ru", "RUS"],
        ["1998", "cz", "CZE", "ru", "RUS", "fi", "FIN"]
    ],
    "teamGroups": {
        "Canada": "A", "Czechia": "A", "Switzerland": "A", "France": "A",
        "Finland": "B", "Sweden": "B", "Slovakia": "B", "Italy": "B",
        "USA": "C", "Germany": "C", "Latvia": "C", "Denmark": "C"
    }
};

// Helper function for group colors
const getGrpColor = (grp) => grp === 'A' ? '#c0392b' : grp === 'B' ? '#2980b9' : grp === 'C' ? '#27ae60' : 'inherit';

// Initialize tables after DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    // Load data from data.json and then initialize
    fetch('data.json')
        .then(response => response.json())
        .then(jsonData => {
            // Merge JSON data with inline data
            if (jsonData.storedScores) {
                window.HockeyData.storedScores = Object.assign({}, window.HockeyData.storedScores, jsonData.storedScores);
            }
            if (jsonData.storedESPNStats) {
                window.HockeyData.storedESPNStats = jsonData.storedESPNStats;
            }
            // Initialize after loading data
            injectTables();
            updateStandings();
        })
        .catch(err => {
            console.log('Using inline data (data.json not loaded):', err);
            // Fallback to inline data - already set
            injectTables();
            updateStandings();
        });
});

function injectTables() {
    const data = window.HockeyData || {};
    const prelims = data.prelims || [];
    const knockouts = data.knockouts || [];
    const historyData = data.historyData || [];
    const storedScores = data.storedScores || {};
    const flagMap = data.flagMap || {};

    const getFlagImg = (name) => {
        let code = null;
        for (const key in flagMap) {
            if (name.indexOf(key) !== -1) { code = flagMap[key]; break; }
        }
        if (!code) return ''; // No flag for placeholders like "Reseed 1", "Win QF", etc.
        return '<img src="https://flagcdn.com/w20/' + code + '.png" style="width:16px; height:11px; vertical-align:-1px; margin:0 4px;">';
    };
    
    // Helper to format team name appropriately for knockouts
    const formatKOTeam = (name, isHome) => {
        const flag = getFlagImg(name);
        if (flag) {
            // Real team - show 3-letter code + flag
            const abbr = name.substring(0,3).toUpperCase();
            return isHome ? abbr + ' ' + flag : flag + ' ' + abbr;
        } else {
            // Placeholder - show as-is
            return name;
        }
    };

    // Preliminaries with editable score boxes
    const pBody = document.getElementById('sched-prelims-v');
    if (pBody) {
        pBody.innerHTML = '';
        prelims.forEach(g => {
            const tr = document.createElement('tr');
            tr.innerHTML = '<td class="c-grp" style="padding:3px 8px; color:' + getGrpColor(g.g) + '">' + g.g + '</td>' +
                '<td class="c-ven" style="padding:3px 8px;">' + g.v + '</td>' +
                '<td class="c-date" style="padding:3px 8px;">' + g.d + '</td>' +
                '<td class="c-time" style="padding:3px 8px;">' + g.t + '</td>' +
                '<td class="c-match" style="padding:3px 8px;">' +
                    '<span class="team-home">' + g.h.substring(0,3).toUpperCase() + ' ' + getFlagImg(g.h) + '</span>' +
                    '<span class="score-area">' +
                        '<span class="sb" contenteditable="true" data-key="' + g.id + '-h">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                        '<span class="sb" contenteditable="true" data-key="' + g.id + '-a">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                    '</span>' +
                    '<span class="team-away">' + getFlagImg(g.a) + ' ' + g.a.substring(0,3).toUpperCase() + '</span>' +
                '</td>';
            pBody.appendChild(tr);
        });
    }

    // Knockouts with editable score boxes (skip qualification round - shown separately)
    const kBody = document.getElementById('sched-ko-v');
    if (kBody) {
        kBody.innerHTML = '';
        knockouts.filter(g => !g.header || g.header !== 'QUALIFICATION ROUND').forEach(g => {
            if (g.g === 'Q') return; // Skip qualification games
            const tr = document.createElement('tr');
            if (g.header) {
                tr.innerHTML = '<td colspan="5" style="background:#f4f4f4; text-align:center; font-weight:900; font-size:12px; border-bottom:1px solid #000; padding:4px 0 8.8px 0;">' + g.header + '</td>';
            } else {
                tr.innerHTML = '<td class="c-grp" style="padding:8.8px 0">' + g.g + '</td>' +
                    '<td class="c-ven" style="padding:8.8px 5px;">' + g.v + '</td>' +
                    '<td class="c-date" style="width:85px; padding:8.8px 5px;">' + g.d + '</td>' +
                    '<td class="c-time" style="width:50px; padding:8.8px 5px;">' + g.t + '</td>' +
                    '<td class="c-match" style="padding:8.8px 5px;">' +
                        '<span class="team-home">' + formatKOTeam(g.h, true) + '</span>' +
                        '<span class="score-area">' +
                            '<span class="sb" contenteditable="true" data-key="' + g.id + '-h">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                            '<span class="sb" contenteditable="true" data-key="' + g.id + '-a">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                        '</span>' +
                        '<span class="team-away">' + formatKOTeam(g.a, false) + '</span>' +
                    '</td>';
            }
            kBody.appendChild(tr);
        });
    }

    // Qualification Round games on seeding page - now handled in updateSeeds()
    // This will be populated with actual team names after standings are computed

    // History
    const hBody = document.getElementById('history-v');
    if (hBody) {
        hBody.innerHTML = '';
        historyData.forEach(r => {
            hBody.innerHTML += '<tr><td>' + r[0] + '</td><td><img src="https://flagcdn.com/w20/' + r[1] + '.png" style="width:14px;"> ' + r[2] + '</td>' +
                '<td><img src="https://flagcdn.com/w20/' + r[3] + '.png" style="width:14px;"> ' + r[4] + '</td>' +
                '<td><img src="https://flagcdn.com/w20/' + r[5] + '.png" style="width:14px;"> ' + r[6] + '</td></tr>';
        });
    }

    // Daily buzz - Current date is Sun Feb 15
    const todayStr = 'Sun Feb 15';
    const yesterdayStr = 'Sat Feb 14';
    const tomorrowStr = 'Tue Feb 17';

    // Consistent row style with fixed-width time column
    const buzzRowStyle = 'display:flex; align-items:center; font-size:13px; font-weight:bold; padding:4px 0;';
    const grpColStyle = 'width:18px; text-align:center; font-weight:900; margin-right:4px; font-size:12px;';
    const venColStyle = 'width:16px; text-align:center; margin-right:3px; font-size:12px; color:#888;';
    const timeColStyle = 'width:55px; text-align:center; font-weight:900; margin-right:6px; font-size:12px;';
    const scoreBoxStyle = 'margin:0 4px; background:#000; color:#fff; padding:3px 7px; border-radius:3px; min-width:40px; text-align:center; font-size:13px;';

    const yBuzz = document.getElementById('yesterday-buzz-v');
    if (yBuzz) {
        yBuzz.innerHTML = '';
        prelims.filter(m => m.d === yesterdayStr).forEach(m => {
            yBuzz.innerHTML += '<div style="' + buzzRowStyle + '">' +
                '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                '<span style="' + venColStyle + '">' + m.v + '</span>' +
                '<span style="' + timeColStyle + 'color:#c0392b;">F</span>' +
                '<span style="flex:1; text-align:right; padding-right:5px;">' + m.h + ' ' + getFlagImg(m.h) + '</span>' +
                '<span style="' + scoreBoxStyle + '">' + (storedScores[m.id + '-h'] || '0') + '-' + (storedScores[m.id + '-a'] || '0') + '</span>' +
                '<span style="flex:1; text-align:left; padding-left:5px;">' + getFlagImg(m.a) + ' ' + m.a + '</span>' +
                '</div>';
        });
    }

    const tBuzz = document.getElementById('today-buzz-v');
    if (tBuzz) {
        tBuzz.innerHTML = '';
        prelims.filter(m => m.d === todayStr).forEach(m => {
            const homeScore = storedScores[m.id + '-h'];
            const awayScore = storedScores[m.id + '-a'];
            const hasScore = homeScore && awayScore && homeScore !== '' && awayScore !== '';
            
            if (hasScore) {
                // Game is finished - show final score
                tBuzz.innerHTML += '<div style="' + buzzRowStyle + '">' +
                    '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                    '<span style="' + venColStyle + '">' + m.v + '</span>' +
                    '<span style="' + timeColStyle + 'color:#c0392b;">F</span>' +
                    '<span style="flex:1; text-align:right; padding-right:5px;">' + m.h + ' ' + getFlagImg(m.h) + '</span>' +
                    '<span style="' + scoreBoxStyle + '">' + homeScore + '-' + awayScore + '</span>' +
                    '<span style="flex:1; text-align:left; padding-left:5px;">' + getFlagImg(m.a) + ' ' + m.a + '</span>' +
                    '</div>';
            } else {
                // Game hasn't started - show time
                tBuzz.innerHTML += '<div style="' + buzzRowStyle + '">' +
                    '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                    '<span style="' + venColStyle + '">' + m.v + '</span>' +
                    '<span style="' + timeColStyle + 'color:#c0392b;">' + m.t + '</span>' +
                    '<span style="flex:1; text-align:right; padding-right:5px;">' + m.h + ' ' + getFlagImg(m.h) + '</span>' +
                    '<span style="' + scoreBoxStyle + 'background:#eee; color:#333;">vs</span>' +
                    '<span style="flex:1; text-align:left; padding-left:5px;">' + getFlagImg(m.a) + ' ' + m.a + '</span>' +
                    '</div>';
            }
        });
    }

    const tmBuzz = document.getElementById('tomorrow-buzz-v');
    if (tmBuzz) {
        tmBuzz.innerHTML = '';
        prelims.filter(m => m.d === tomorrowStr).forEach(m => {
            tmBuzz.innerHTML += '<div style="' + buzzRowStyle + '">' +
                '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                '<span style="' + venColStyle + '">' + m.v + '</span>' +
                '<span style="' + timeColStyle + 'color:#2980b9;">' + m.t + '</span>' +
                '<span style="flex:1; text-align:right; padding-right:5px;">' + m.h + ' ' + getFlagImg(m.h) + '</span>' +
                '<span style="' + scoreBoxStyle + 'background:#f0f0f0; color:#666;">vs</span>' +
                '<span style="flex:1; text-align:left; padding-left:5px;">' + getFlagImg(m.a) + ' ' + m.a + '</span>' +
                '</div>';
        });
    }

    // Display-only: remove contenteditable from score boxes
    document.querySelectorAll('.sb').forEach(el => {
        el.removeAttribute('contenteditable');
    });
}

// H2H Tiebreaker Functions
function getH2HResults(teams, prelims, storedScores) {
    const h2h = {};
    teams.forEach(t => { h2h[t] = { p: 0, gf: 0, ga: 0 }; });
    prelims.forEach(g => {
        if (!teams.includes(g.h) || !teams.includes(g.a)) return;
        const hRaw = (storedScores[g.id + '-h'] || '').toString().toLowerCase();
        const aRaw = (storedScores[g.id + '-a'] || '').toString().toLowerCase();
        if (!hRaw || !aRaw || isNaN(parseInt(hRaw)) || isNaN(parseInt(aRaw))) return;
        const hScore = parseInt(hRaw); const aScore = parseInt(aRaw);
        const isOT = hRaw.includes('*') || aRaw.includes('*') || hRaw.includes('t') || aRaw.includes('t');
        h2h[g.h].gf += hScore; h2h[g.h].ga += aScore;
        h2h[g.a].gf += aScore; h2h[g.a].ga += hScore;
        if (hScore > aScore) {
            if (isOT) { h2h[g.h].p += 2; h2h[g.a].p += 1; }
            else { h2h[g.h].p += 3; }
        } else if (aScore > hScore) {
            if (isOT) { h2h[g.a].p += 2; h2h[g.h].p += 1; }
            else { h2h[g.a].p += 3; }
        }
    });
    return h2h;
}

function sortTeamsWithTiebreaker(teams, results, prelims, storedScores) {
    // First sort by points and GD
    teams.sort((a, b) => results[b].p - results[a].p || (results[b].gf - results[b].ga) - (results[a].gf - results[a].ga));
    
    // Find groups of tied teams (same points)
    const sorted = [];
    let i = 0;
    while (i < teams.length) {
        const tiedGroup = [teams[i]];
        let j = i + 1;
        while (j < teams.length && results[teams[j]].p === results[teams[i]].p) {
            tiedGroup.push(teams[j]);
            j++;
        }
        if (tiedGroup.length > 1) {
            // Apply H2H tiebreaker
            const h2h = getH2HResults(tiedGroup, prelims, storedScores);
            tiedGroup.sort((a, b) => h2h[b].p - h2h[a].p || (h2h[b].gf - h2h[b].ga) - (h2h[a].gf - h2h[a].ga) || (results[b].gf - results[b].ga) - (results[a].gf - results[a].ga));
        }
        sorted.push(...tiedGroup);
        i = j;
    }
    return sorted;
}

// Store scores in memory
let storedScoresLocal = {};

function updateStandings() {
    const data = window.HockeyData || {};
    const prelims = data.prelims || [];
    const storedScores = Object.assign({}, data.storedScores || {}, storedScoresLocal);
    const flagMap = data.flagMap || {};
    const teamGroups = data.teamGroups || {};

    const results = {};
    Object.keys(teamGroups).forEach(team => { results[team] = { w:0, otw:0, otl:0, l:0, gf:0, ga:0, gd:0, p:0 }; });
    prelims.forEach(g => {
        const hRaw = (storedScores[g.id + '-h'] || '').toString().toLowerCase();
        const aRaw = (storedScores[g.id + '-a'] || '').toString().toLowerCase();
        if (!hRaw || !aRaw || isNaN(parseInt(hRaw)) || isNaN(parseInt(aRaw))) return;
        const hScore = parseInt(hRaw); const aScore = parseInt(aRaw);
        const isOT = hRaw.includes('*') || aRaw.includes('*') || hRaw.includes('t') || aRaw.includes('t');
        results[g.h].gf += hScore; results[g.h].ga += aScore;
        results[g.a].gf += aScore; results[g.a].ga += hScore;
        if (hScore > aScore) {
            if (isOT) { results[g.h].otw++; results[g.h].p += 2; results[g.a].otl++; results[g.a].p += 1; }
            else { results[g.h].w++; results[g.h].p += 3; results[g.a].l++; }
        } else if (aScore > hScore) {
            if (isOT) { results[g.a].otw++; results[g.a].p += 2; results[g.h].otl++; results[g.h].p += 1; }
            else { results[g.a].w++; results[g.a].p += 3; results[g.h].l++; }
        }
    });
    const container = document.getElementById('standings-tables-container');
    if (!container) return;
    container.innerHTML = '';
    ['A', 'B', 'C'].forEach(grp => {
        let teams = Object.keys(teamGroups).filter(t => teamGroups[t] === grp);
        teams = sortTeamsWithTiebreaker(teams, results, prelims, storedScores);
        let html = `<table class="std-table"><thead><tr><th class="th-${grp}" colspan="11">GROUP ${grp}</th></tr><tr><th width="2%" style="text-align:center;">Rank</th><th width="35%">Team</th><th width="7%" style="text-align:center;">GP</th><th width="7%" style="text-align:center;">W</th><th width="7%" style="text-align:center;">OTW</th><th width="7%" style="text-align:center;">OTL</th><th width="7%" style="text-align:center;">L</th><th width="7%" style="text-align:center;">GF</th><th width="7%" style="text-align:center;">GA</th><th width="7%" style="text-align:center;">GD</th><th width="7%" style="text-align:center;">PTS</th></tr></thead><tbody>`;
        teams.forEach((t, idx) => {
            const r = results[t];
            const gamesPlayed = r.w + r.otw + r.otl + r.l;
            const rank = idx + 1;
            html += `<tr><td style="padding-right:2px;">${rank}</td><td style="padding-left:4px;"><img src="https://flagcdn.com/w20/${flagMap[t]}.png" class="flag-icon"> ${t}</td><td>${gamesPlayed}</td><td>${r.w}</td><td>${r.otw}</td><td>${r.otl}</td><td>${r.l}</td><td>${r.gf}</td><td>${r.ga}</td><td>${r.gf - r.ga}</td><td>${r.p}</td></tr>`;
        });
        container.innerHTML += html + `</tbody></table>`;
    });
    
    // Update seeds 1-12
    updateSeeds(results, flagMap, teamGroups);
}

function updateSeeds(results, flagMap, teamGroups) {
    const data = window.HockeyData || {};
    const knockouts = data.knockouts || [];
    const prelims = data.prelims || [];
    const storedScores = Object.assign({}, data.storedScores || {}, storedScoresLocal);
    
    // Get all teams sorted by Olympic seeding rules
    // 1. Group standings using tiebreaker logic
    const groupStandings = {};
    ['A', 'B', 'C'].forEach(grp => {
        const teamsInGrp = Object.keys(teamGroups).filter(t => teamGroups[t] === grp);
        groupStandings[grp] = sortTeamsWithTiebreaker(teamsInGrp, results, prelims, storedScores).map(t => ({
            name: t,
            ...results[t],
            gd: results[t].gf - results[t].ga
        }));
    });
    
    // 2. Seeds 1-3: Group winners sorted by pts/GD/GF
    const groupWinners = [
        groupStandings['A'][0],
        groupStandings['B'][0],
        groupStandings['C'][0]
    ];
    groupWinners.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // 3. Seed 4: Best second-place team
    const secondPlace = [
        groupStandings['A'][1],
        groupStandings['B'][1],
        groupStandings['C'][1]
    ];
    secondPlace.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // 4. Seeds 5-12: Remaining teams sorted by pts/GD/GF
    const remaining = [
        secondPlace[1], secondPlace[2], // 2nd and 3rd best second-place
        groupStandings['A'][2], groupStandings['A'][3],
        groupStandings['B'][2], groupStandings['B'][3],
        groupStandings['C'][2], groupStandings['C'][3]
    ];
    remaining.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // Combine all seeds in order
    const allTeams = [...groupWinners, secondPlace[0], ...remaining];
    
    // Populate seeds 1-12 (only on seeding page)
    const seedingPage = document.getElementById('page-p9');
    if (seedingPage) {
        const seedRows = seedingPage.querySelectorAll('.seed-row');
        for (let i = 0; i < seedRows.length && i < allTeams.length; i++) {
            const team = allTeams[i];
            const row = seedRows[i];
            const nameEl = row.querySelector('.seed-name');
            const grpEl = row.querySelector('.seed-grp');
            const recEl = row.querySelector('.seed-record');
            const statEls = row.querySelectorAll('.seed-stat');
            
            // Set team name with flag for all seeds
            if (nameEl) {
                const flagCode = flagMap[team.name];
                if (flagCode) {
                    // Top 4: Full name with flag
                    // Seeds 5-12: Centered 3-letter abbreviation with flag
                    if (i < 4) {
                        nameEl.innerHTML = '<img src="https://flagcdn.com/w20/' + flagCode + '.png" class="flag-icon" style="margin-right:4px; vertical-align:middle;"> ' + team.name;
                    } else {
                        nameEl.innerHTML = '<img src="https://flagcdn.com/w20/' + flagCode + '.png" class="flag-icon" style="margin-right:4px; vertical-align:middle;"> ' + team.name.substring(0,3).toUpperCase();
                        nameEl.style.textAlign = 'center';
                    }
                } else {
                    nameEl.textContent = team.name;
                }
            }
            
            // For top 4 seeds (i = 0-3), show group, GP and record
            if (i < 4 && grpEl && recEl) {
                const grp = teamGroups[team.name];
                grpEl.textContent = grp || '';
                grpEl.style.color = getGrpColor(grp);
                const gpEl = row.querySelector('.seed-gp');
                if (gpEl) gpEl.textContent = team.w + team.otw + team.otl + team.l;
                recEl.textContent = team.w + '-' + team.otw + '-' + team.otl + '-' + team.l;
            }
            
            // For seeds 5-12, show GP
            if (i >= 4) {
                const gpEl = row.querySelector('.seed-gp');
                if (gpEl) gpEl.textContent = team.w + team.otw + team.otl + team.l;
            }
            
            // For all seeds, show GD and Pts
            if (statEls.length >= 2) {
                statEls[0].textContent = team.gd;
                statEls[1].textContent = team.p;
            }
        }
    }
    
    // Update qualification games with actual team names
    const qualGames = document.getElementById('qual-games-v');
    if (qualGames) {
        qualGames.innerHTML = '';
        knockouts.filter(g => g.g === 'Q').forEach(g => {
            // Replace Seed X with actual team names
            let homeName = g.h;
            let awayName = g.a;
            let homeFlag = '';
            let awayFlag = '';
            
            if (homeName.startsWith('Seed ')) {
                const seedNum = parseInt(homeName.replace('Seed ', ''));
                if (allTeams[seedNum - 1]) {
                    homeName = allTeams[seedNum - 1].name;
                    homeFlag = flagMap[homeName];
                }
            }
            if (awayName.startsWith('Seed ')) {
                const seedNum = parseInt(awayName.replace('Seed ', ''));
                if (allTeams[seedNum - 1]) {
                    awayName = allTeams[seedNum - 1].name;
                    awayFlag = flagMap[awayName];
                }
            }
            
            const tr = document.createElement('tr');
            tr.innerHTML = '<td class="c-grp" style="padding:6px 4px; text-align:center; width:18px;">' + g.g + '</td>' +
                '<td class="c-ven" style="padding:6px 4px; text-align:center; width:18px;">' + g.v + '</td>' +
                '<td class="c-date" style="padding:6px 4px; text-align:center; width:68px;">' + g.d + '</td>' +
                '<td class="c-time" style="padding:6px 4px; text-align:center; width:42px;">' + g.t + '</td>' +
                '<td class="c-flag" style="padding:6px 7px 6px 12px; text-align:right; width:22px;">' +
                    (homeFlag ? '<img src="https://flagcdn.com/w20/' + homeFlag + '.png" class="flag-icon" style="vertical-align:middle;">' : '') +
                '</td>' +
                '<td class="c-match" style="padding:6px 5px; text-align:center;">' +
                    '<span style="display:inline-block; min-width:80px; text-align:right; padding-right:5px;">' + homeName + '</span>' +
                    '<span class="score-area">' +
                        '<span class="sb">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                        '<span class="sb">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                    '</span>' +
                    '<span style="display:inline-block; min-width:80px; text-align:left; padding-left:5px;">' + awayName + '</span>' +
                '</td>' +
                '<td class="c-flag" style="padding:6px 3px; text-align:left; width:22px;">' +
                    (awayFlag ? '<img src="https://flagcdn.com/w20/' + awayFlag + '.png" class="flag-icon" style="vertical-align:middle;">' : '') +
                '</td>';
            qualGames.appendChild(tr);
        });
        
        // Display-only: no handlers needed
    }
}

// Display-only version - no editing allowed
window.handleInput = function(el, key) {
    // Disabled in clean version
};

// Display-only: no sync indicator needed
function showSync() {
    // Disabled in clean version
}

// Display-only version - no save functions needed
window.masterSave = function() {
    alert('This is the clean display version. Update data.json on the server to change scores.');
};
window.exportDataJSON = function() {
    alert('This is the clean display version. No export needed.');
};
window.saveUpdatedHTML = function() {
    alert('This is the clean display version. No export needed.');
};

// Display-only version - no API calls needed



// Display-only version - no API calls
window.refreshScores = function() {
    alert('This is the clean display version. Update data.json on the server to change scores.');
};

function updateScoringTableData(scorers) {
    const tbody = document.querySelector('#page-p_new8 table tbody');
    if (!tbody) {
        console.error('Could not find scoring table tbody');
        return;
    }
    
    console.log('Updating scoring table with', scorers.length, 'scorers');
    
    const teamToCountry = {
        'CAN': 'ca', 'USA': 'us', 'SWE': 'se', 'FIN': 'fi',
        'SVK': 'sk', 'CZE': 'cz', 'SWI': 'ch', 'GER': 'de',
        'LAT': 'lv', 'DEN': 'dk', 'ITA': 'it', 'FRA': 'fr'
    };
    
    let html = '';
    scorers.forEach((s, idx) => {
        const flag = teamToCountry[s.team] || 'ca';
        const rankNum = s.rank.replace('.', '');
        html += `<tr style="background:#fff;">
            <td style="padding:3px; text-align:center; font-size:11px;">${rankNum}</td>
            <td style="padding:3px 0 3px 5px; font-weight:700; font-size:13px;">
                <img src='https://flagcdn.com/w20/${flag}.png' style='width:18px; height:12px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:4px;'> ${s.name}
            </td>
            <td style="padding:3px; font-size:12px; text-align:center;">${s.team}</td>
            <td style="padding:3px; text-align:center;">${s.gp}</td>
            <td style="padding:3px; text-align:center;">${s.goals}</td>
            <td style="padding:3px; text-align:center;">${s.assists}</td>
            <td style="padding:3px; text-align:center; font-weight:bold;">${s.points}</td>
        </tr>`;
    });
    
    tbody.innerHTML = html;
    console.log('Scoring table updated successfully');
}

function updateGoalieTableData(goalies) {
    const tables = document.querySelectorAll('#page-p_new8 table');
    if (tables.length < 2) {
        console.error('Could not find goalie table - only found', tables.length, 'tables');
        return;
    }
    
    const tbody = tables[1].querySelector('tbody');
    if (!tbody) {
        console.error('Could not find goalie table tbody');
        return;
    }
    
    console.log('Updating goalie table with', goalies.length, 'goalies');
    
    const teamToCountry = {
        'CAN': 'ca', 'USA': 'us', 'SWE': 'se', 'FIN': 'fi',
        'SVK': 'sk', 'CZE': 'cz', 'SWI': 'ch', 'GER': 'de',
        'LAT': 'lv', 'DEN': 'dk', 'ITA': 'it', 'FRA': 'fr'
    };
    
    let html = '';
    goalies.forEach((g, idx) => {
        const flag = teamToCountry[g.team] || 'ca';
        const rankNum = g.rank.replace('.', '');
        html += `<tr style="background:#fff;">
            <td style="padding:3px; text-align:center; font-size:11px;">${rankNum}</td>
            <td style="padding:3px 0 3px 5px; font-weight:700; font-size:13px;">
                <img src='https://flagcdn.com/w20/${flag}.png' style='width:18px; height:12px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:4px;'> ${g.name}
            </td>
            <td style="padding:3px; font-size:12px; text-align:center;">${g.team}</td>
            <td style="padding:3px; text-align:center;">${g.gp}</td>
            <td style="padding:3px; text-align:center;">${g.wins}</td>
            <td style="padding:3px; text-align:center;">${g.gaa}</td>
            <td style="padding:3px; text-align:center;">${g.svp}</td>
        </tr>`;
    });
    
    tbody.innerHTML = html;
    console.log('Goalie table updated successfully');
}

// Initialize on page load (display-only mode)
document.addEventListener('DOMContentLoaded', () => {
    // Initialize tables from embedded HockeyData
    injectTables();
    updateStandings();
    
    // Load cached ESPN stats from HockeyData.storedESPNStats
    const data = window.HockeyData || {};
    const cached = data.storedESPNStats || {};
    
    if (cached.scorers && cached.scorers.length > 0) {
        console.log('Loading cached scorers:', cached.scorers);
        updateScoringTableData(cached.scorers);
    }
    
    if (cached.goalies && cached.goalies.length > 0) {
        console.log('Loading cached goalies:', cached.goalies);
        updateGoalieTableData(cached.goalies);
    }
});
</script>

</body>
</html>
