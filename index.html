<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olympic Hockey Guide 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="flipbook.css">
    <link rel="stylesheet" href="mobile.css">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<body>

<div class="book" id="hockey-book">

    <!-- Page 0: Cover + Introduction -->
    <div class="page">
        <div class="front cover" id="page-p1">
            <img src="cover.png" class="bg-img" alt="Cover">
            <div style="position:absolute; bottom:12px; right:12px; z-index:1;">
                <img src="ono.png" alt="ONO" style="width:28px; height:auto; opacity:0.7;">
            </div>
        </div>
        <div class="back panel intro-page" id="page-p_intro">
            <h2>Introduction</h2>
            <div class="intro-content">
                <p><strong>The Boys Are Back</strong><br>
                After a 12-year wait, the world's greatest stage for hockey is finally back in its true form. With NHL players returning to the Olympic ice for the first time since 2014, the Milano Cortina 2026 Men's Hockey Tournament isn't just another competitionâ€”it's the definitive battle for global supremacy. Follow here from the first puck drop on February 11 to the gold medal game on February 22, as 12 nations battle on Milan's Santagiulia and Rho Arenas.</p>        
                <p><strong>The Best-on-Best Era</strong><br>
                The storylines are already legendary. For the first time ever, we get to see generational talents like Sidney Crosby and Connor McDavid share the same sweater for Team Canada. Meanwhile, the United States arrives with perhaps their most skilled roster in history, led by Auston Matthews and a powerhouse defense featuring Quinn Hughes.</p>
                <p><strong>Olympic Hockey Legacy</strong><br>
                Men's hockey debuted at the 1920 Summer Olympics before becoming a Winter Games staple in 1924. Canada dominated early, winning the first four gold medals and has since claimed nine totalâ€”the most of any nation. The U.S. enters with two gold medals (tied for third all-time) and a record eight silvers. Reigning champion Finland seeks to match Canada's 2010-2014 back-to-back feat, defending their first-ever gold won in 2022.</p>
            </div>
            <div class="intro-logos" style="transform: translateY(-4px);">
                <img src="https://upload.wikimedia.org/wikipedia/en/6/60/2026_Winter_Olympics_logo.png?20210922122018" alt="Milano Cortina 2026">
                <img src="https://img.olympics.com/images/image/private/t_original_760/f_auto/primary/jbbqfkafamqfxovy0iut" alt="Olympic Rings">
                <img src="https://img.olympics.com/images/image/private/t_s_9-16_800/f_auto/primary/aucd9penq1yskqrysm8n" alt="Milano Cortina Mascot">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Canadian_Olympic_Committee_logo.svg/960px-Canadian_Olympic_Committee_logo.svg.png?20181224225813" alt="Team Canada">
            </div>
            <div class="intro-footer" style="transform: translateY(-4px);">
                FEBRUARY 11 - 22, 2026
            </div>
        </div>
    </div>

    <!-- Page 1: Daily Buzz + Groups (New Order: 3,4) -->
    <div class="page">
        <div class="front panel" id="page-p5" style="padding: 12px 15px;">
            <h2 style="margin-bottom:8px;">Daily Buzz: Sunday, Feb 15</h2>
            <div style="margin-bottom: 8px;">
                <div style="font-size: 12px; font-weight: 900; color: #444; border-bottom: 2px solid #eee; padding-bottom: 4px; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1.5px;">Yesterday's Scores</div>
                <div id="yesterday-buzz-v" style="display: flex; flex-direction: column; gap: 2px;"></div>
            </div>
            <div style="margin-bottom: 8px;">
                <div style="font-size: 12px; font-weight: 900; color: #444; border-bottom: 2px solid #eee; padding-bottom: 4px; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1.5px;">Today's Schedule</div>
                <div id="today-buzz-v" style="display: flex; flex-direction: column; gap: 2px;"></div>
            </div>
            <div style="margin-top:auto;">
                <div style="font-size: 12px; font-weight: 900; color: #444; border-bottom: 2px solid #eee; padding-bottom: 4px; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1.5px;">Tomorrow's Games</div>
                <div id="tomorrow-buzz-v" style="display: flex; flex-direction: column; gap: 2px;"></div>
            </div>
            <div style="margin-top: auto; border-top: 1px dashed #ddd; padding-top: 6px; text-align: center; color: #bbb; font-size: 10px; font-style: italic;">"Gold isn't won on the ice, it's won in the heart."</div>
        </div>
        <div class="back panel" id="page-p7">
            <h2>Group Standings</h2>
            <div class="flex-table-container" id="standings-tables-container"></div>
            <div style="margin-top:auto; font-size:9.5px; border-top:1px solid #ddd; padding-top:4px; color:#000; line-height:1.3;">
                <div><strong>Points </strong>   =   Win Ã— 3   |   OT/SO Win Ã— 2   |   OT/SO Loss Ã— 1 <p> <strong>Tiebreaker:</strong> H2H record, then GD among tied teams.</p></div>
            </div>
        </div>
    </div>

    <!-- Page 2: Preliminaries + Seeding (New Order: 5,6) -->
    <div class="page">
        <div class="front panel" id="page-p8" style="padding: 12px 16px 8px 16px;">
            <h2 style="margin-bottom: 6px;">Preliminaries</h2>
            <div class="flex-table-container">
                <table id="table-prelims" style="font-size: 13.1px; width: 100%; table-layout: fixed;">
                    <colgroup>
                        <col style="width: 28px;">
                        <col style="width: 18px;">
                        <col style="width: 80px;">
                        <col style="width: 50px;">
                        <col style="width: auto;">
                    </colgroup>
                    <thead><tr><th class="c-grp" style="padding: 5px 8px;">G</th><th class="c-ven" style="padding: 5px 8px;">V</th><th class="c-date" style="padding: 5px 8px;">Date</th><th class="c-time" style="padding: 5px 8px;">ET</th><th class="c-match" style="padding: 5px 8px;">Matchup</th></tr></thead>
                    <tbody id="sched-prelims-v"></tbody>
                </table>
            </div>
            <div style="margin-top:auto; font-size:9.5px; color:#000; border-top:1px solid #ddd; padding-top:4px; display:flex; justify-content:space-between;"><span>S: Santagiulia</span><span>R: Rho Fiera</span></div>
        </div>
        <div class="back panel" id="page-p9">
            <h2>Seeding (1-12)</h2>
            <div style="display:flex; border-bottom:1px solid #000;">
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:5px; color:#000; align-items:center; height:20px; overflow:hidden;">
                        <span style="width:28px; flex-shrink:0; box-sizing:border-box; display:flex; align-items:center; justify-content:center;">#</span>
                        <span style="flex:1; box-sizing:border-box; display:flex; align-items:center;">Team Name</span>
                        <span style="width:36px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center; transform:translateX(-15px);">Group</span>
                        <span style="width:28px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center; transform:translateX(-10px);">GP</span>
                        <span style="width:70px; flex-shrink:0; text-align:center; letter-spacing:0.8px; box-sizing:border-box; display:flex; align-items:center; justify-content:center; transform:translateX(-5px);">Record</span>
                        <span style="width:30px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center; transform:translateX(3px);">GD</span>
                        <span style="width:30px; flex-shrink:0; text-align:center; box-sizing:border-box; display:flex; align-items:center; justify-content:center; transform:translateX(2px);">PTS</span>
                        <span style="width:5%; box-sizing:border-box;"></span>
                    </div>
                    <div class="seed-row seed-row-upper" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">1</div><div class="seed-name" style="flex:1; text-align:left;"></div><div class="seed-grp" style="width:36px; flex-shrink:0; text-align:center; transform:translateX(-15px);"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center; transform:translateX(-10px);"></div><div class="seed-record" style="width:70px; flex-shrink:0; text-align:center; transform:translateX(-5px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(3px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(2px);"></div><div style="width:3%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">2</div><div class="seed-name" style="flex:1; text-align:left;"></div><div class="seed-grp" style="width:36px; flex-shrink:0; text-align:center; transform:translateX(-15px);"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center; transform:translateX(-10px);"></div><div class="seed-record" style="width:70px; flex-shrink:0; text-align:center; transform:translateX(-5px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(3px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(2px);"></div><div style="width:3%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">3</div><div class="seed-name" style="flex:1; text-align:left;"></div><div class="seed-grp" style="width:36px; flex-shrink:0; text-align:center; transform:translateX(-15px);"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center; transform:translateX(-10px);"></div><div class="seed-record" style="width:70px; flex-shrink:0; text-align:center; transform:translateX(-5px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(3px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(2px);"></div><div style="width:3%;"></div></div>
                    <div class="seed-row seed-row-upper" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">4</div><div class="seed-name" style="flex:1; text-align:left;"></div><div class="seed-grp" style="width:36px; flex-shrink:0; text-align:center; transform:translateX(-15px);"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center; transform:translateX(-10px);"></div><div class="seed-record" style="width:70px; flex-shrink:0; text-align:center; transform:translateX(-5px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(3px);"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center; transform:translateX(2px);"></div><div style="width:3%;"></div></div>
                </div>
                <div class="vert-label">BYE TO QF</div>
            </div>
            <!-- Qualification: Two columns side by side -->
            <div style="display:flex; gap:15px; margin-top:4px;">
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:3px; padding:0; color:#000;">
                        <span style="width:28px; flex-shrink:0; text-align:center;">#</span>
                        <span style="flex:1; text-align:center;">Team</span>
                        <span style="width:28px; flex-shrink:0; text-align:center;">GP</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">GD</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">PTS</span>
                    </div>
                    <div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">5</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">6</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">7</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">8</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                    </div>
                </div>
                <div style="flex:1;">
                    <div style="display:flex; gap:0; font-size:11px; font-weight:bold; margin-bottom:3px; padding:0; color:#000;">
                        <span style="width:28px; flex-shrink:0; text-align:center;">#</span>
                        <span style="flex:1; text-align:center;">Team</span>
                        <span style="width:28px; flex-shrink:0; text-align:center;">GP</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">GD</span>
                        <span style="width:30px; flex-shrink:0; text-align:center;">PTS</span>
                    </div>
                    <div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">9</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">10</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">11</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                        <div class="seed-row seed-row-lower" style="gap:4px;"><div class="seed-num" style="width:28px; flex-shrink:0; text-align:center; font-weight:bold;">12</div><div class="seed-name" style="flex:1; text-align:center;"></div><div class="seed-gp" style="width:28px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div><div class="seed-stat" style="width:30px; flex-shrink:0; text-align:center;"></div></div>
                    </div>
                </div>
                <div class="vert-label">QUALIFICATION</div>
            </div>
            <!-- Qualification Round Header -->
            <h2 style="margin-top:4px; margin-bottom:4px;">Qualification Round</h2>
            <!-- Qualification Round Games -->
            <div>
                <table style="width:100%; border-collapse:collapse; font-size:12px;">
                    <thead>
                        <tr style="display:none;">
                            <th class="c-grp" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:18px;">G</th>
                            <th class="c-ven" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:18px;">V</th>
                            <th class="c-date" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:68px;">Date</th>
                            <th class="c-time" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:42px;">ET</th>
                            <th class="c-flag" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:22px;"></th>
                            <th class="c-match" style="padding:3px 10px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd;">Matchup</th>
                            <th class="c-flag" style="padding:3px 4px; font-size:10px; font-weight:bold; border-bottom:1px solid #ddd; width:22px;"></th>
                        </tr>
                    </thead>
                    <tbody id="qual-games-v"></tbody>
                </table>
            </div>
            <!-- Simple reseed line -->
            <div style="border-top:1px solid #ccc; margin-top:8px; padding-top:4px; margin-bottom:4px;">
                <div style="font-size:9px; font-weight:600; color:#666; margin-bottom:2px; text-transform:uppercase;">Reseed for Quarterfinals</div>
                <div style="display:flex; width:100%; padding:2px 0;">
                    <span style="width:8%; text-align:center; font-size:12px; font-weight:bold; color:#800;">1 <span style="color:#ccc;">|</span></span>
                    <span style="width:17%; text-align:center;"></span>
                    <span style="width:8%; text-align:center; font-size:12px; font-weight:bold; color:#800;">2 <span style="color:#ccc;">|</span></span>
                    <span style="width:17%; text-align:center;"></span>
                    <span style="width:8%; text-align:center; font-size:12px; font-weight:bold; color:#800;">3 <span style="color:#ccc;">|</span></span>
                    <span style="width:17%; text-align:center;"></span>
                    <span style="width:8%; text-align:center; font-size:12px; font-weight:bold; color:#800;">4 <span style="color:#ccc;">|</span></span>
                    <span style="width:17%; text-align:center;"></span>
                </div>
            </div>
            <div style="font-size:9.5px; color:#000; border-top:1px solid #ddd; padding-top:4px; line-height:1.3;">
                <div style="margin-bottom:3px;"><strong>Seeding:</strong> Group winners â†’ Seeds 1-3. Best 2nd place â†’ Seed 4. Then: Pts > GD > GF > IIHF Rank.</div>
                <div><strong>Semi-Finals:</strong> Highest seed plays lowest, 2nd-highest plays 3rd-highest.</div>
            </div>
        </div>
    </div>

    <!-- Page 3: Knockout + Global Contenders (New Order: 7,8) -->
    <div class="page">
        <div class="front panel" id="page-p10" style="padding-right: 10px;">
            <h2 style="margin-top:0;">Knockout Bracket</h2>
            <div class="flex-table-container">
                <table id="table-ko" style="font-size: 12px; width: 100%; table-layout: fixed;">
                    <colgroup>
                        <col style="width: 30px;">
                        <col style="width: 18px;">
                        <col style="width: 80px;">
                        <col style="width: 50px;">
                        <col style="width: 22px;">
                        <col style="width: auto;">
                        <col style="width: 22px;">
                    </colgroup>
                    <tbody id="sched-ko-v"></tbody>
                </table>
            </div>
            <!-- Podium Footer -->
            <div style="margin-top:4px; padding:6px; background:#f8f8f8; border:1px solid #ddd; border-radius:4px;">
                <div style="display:flex; align-items:flex-end; justify-content:center; gap:0px; height:85px; width:100%;">
                    <!-- Silver (2nd) -->
                    <div style="display:flex; flex-direction:column; align-items:center; flex:1;">
                        <div id="podium-silver" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #999; border-radius:3px; min-width:70px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #C0C0C0 0%, #A8A8A8 100%); width:100%; height:50px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #999; box-shadow:inset 2px 2px 4px rgba(255,255,255,0.7), inset -2px -2px 4px rgba(0,0,0,0.2);">
                            <span style="font-size:20px;">ðŸ¥ˆ</span>
                        </div>
                    </div>
                    <!-- Gold (1st - tallest) -->
                    <div style="display:flex; flex-direction:column; align-items:center; flex:1;">
                        <div id="podium-gold" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #B8860B; border-radius:3px; min-width:80px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #FFD700 0%, #DAA520 100%); width:100%; height:65px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #B8860B; box-shadow:inset 3px 3px 8px rgba(255,255,255,0.8), inset -3px -3px 8px rgba(0,0,0,0.3), 0 6px 12px rgba(0,0,0,0.3); transform:translateY(-5px);">
                            <span style="font-size:24px; text-shadow:2px 2px 4px rgba(0,0,0,0.4);">ðŸ¥‡</span>
                        </div>
                    </div>
                    <!-- Bronze (3rd - shortest) -->
                    <div style="display:flex; flex-direction:column; align-items:center; flex:1;">
                        <div id="podium-bronze" style="font-size:11px; font-weight:bold; text-align:center; margin-bottom:3px; padding:3px 6px; background:#fff; border:1px dashed #8B4513; border-radius:3px; min-width:70px;">TBD</div>
                        <div style="background:linear-gradient(180deg, #CD7F32 0%, #8B4513 100%); width:100%; height:40px; display:flex; align-items:center; justify-content:center; border-radius:3px 3px 0 0; border:1px solid #8B4513; box-shadow:inset 2px 2px 4px rgba(255,255,255,0.5), inset -2px -2px 4px rgba(0,0,0,0.3);">
                            <span style="font-size:18px;">ðŸ¥‰</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="back panel" id="page-p_new8" style="padding: 15px; background: #fdfdfd;">
            <h2>Global Contenders</h2>
            <div style="margin-top: 2px; display: grid; grid-template-columns: 1fr 1fr; gap: 6px 12px; width: calc(100% - 10px); max-width: none; margin-left: 0; margin-right: auto; justify-items: start;">
              <div class="star-card" style="margin:0; display:flex; align-items:center; gap:8px; font-size:13px; padding:8px 10px; background:linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,248,248,0.6) 100%); border:1px solid #ddd; border-radius:6px; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
                <img src="https://flagcdn.com/w80/ca.png" style="width:28px; height:19px; border:1px solid #ccc; border-radius:2px; margin-right:4px; margin-left:0; object-fit: cover;">
                <div style="display:flex; flex-direction:column; justify-content:center; min-width:0; flex:1;">
                  <div style="font-weight:900; color:#222; font-size:14px; margin-bottom:2px;">Canada</div>
                  <div style="color:#666; font-size:11px; font-weight:500; white-space:nowrap;">McDavid, Crosby, MacKinnon</div>
                </div>
              </div>

              <div class="star-card" style="margin:0; display:flex; align-items:center; gap:8px; font-size:13px; padding:8px 10px; background:linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,248,248,0.6) 100%); border:1px solid #ddd; border-radius:6px; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
                <img src="https://flagcdn.com/w80/us.png" style="width:28px; height:19px; border:1px solid #ccc; border-radius:2px; margin-right:4px; margin-left:0; object-fit: cover;">
                <div style="display:flex; flex-direction:column; justify-content:center; min-width:0; flex:1;">
                  <div style="font-weight:900; color:#222; font-size:14px; margin-bottom:2px;">USA</div>
                  <div style="color:#666; font-size:11px; font-weight:500; white-space:nowrap;">Matthews, Tkachuk, Hughes</div>
                </div>
              </div>
            </div>
            
            <!-- Stats Section -->
            <div style="margin-top: 8px;">
              <div style="font-size: 14px; font-weight: 900; color: #c0392b; margin-bottom: 4px; text-transform: uppercase; letter-spacing:1px;">Top 5 Points</div>
              <table style="width:100%; font-size:11px; border-collapse:separate; border-spacing:0 3px; margin-bottom:8px; table-layout:fixed;">
                <thead style="background:#eee;">
                  <tr>
                    <th style="padding:2px; text-align:center; width:4%; font-size:10px;">#</th>
                    <th style="padding:2px 0 2px 3px; text-align:left; width:44%; font-size:10px;">Player</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">Team</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">GP</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">G</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">A</th>
                    <th style="padding:2px; text-align:center; width:11%; font-size:10px;">PTS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Connor McDavid
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">7</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">9</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Macklin Celebrini
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/sk.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Juraj Slafkovsky
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">SVK</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">T2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Sidney Crosby
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">6</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">5</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Nathan MacKinnon
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-weight:bold; font-size:10px;">5</td>
                  </tr>
                </tbody>
              </table>

              <div style="font-size: 14px; font-weight: 900; color: #2980b9; margin-bottom: 4px; text-transform: uppercase; letter-spacing:1px;">Top 5 Goalies</div>
              <table style="width:100%; font-size:11px; border-collapse:separate; border-spacing:0 3px; table-layout:fixed;">
                <thead style="background:#eee;">
                  <tr>
                    <th style="padding:2px; text-align:center; width:4%; font-size:10px;">#</th>
                    <th style="padding:2px 0 2px 3px; text-align:left; width:44%; font-size:10px;">Player</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">Team</th>
                    <th style="padding:2px; text-align:center; width:9%; font-size:10px;">GP</th>
                    <th style="padding:2px; text-align:center; width:8%; font-size:10px;">W</th>
                    <th style="padding:2px; text-align:center; width:10%; font-size:10px;">GAA</th>
                    <th style="padding:2px; text-align:center; width:11%; font-size:10px;">SV%</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Logan Thompson
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.960</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ca.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Jordan Binnington
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">CAN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.950</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/ch.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Leonardo Genoni
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">SUI</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.48</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.949</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">4</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/fi.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Juuse Saros
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">FIN</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">3</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">2</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.34</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.946</td>
                  </tr>
                  <tr style="background:#fff;">
                    <td style="padding:2px; text-align:center; font-size:10px;">5</td>
                    <td style="padding:2px 0 2px 3px; font-weight:700; font-size:11px; white-space:nowrap;">
                      <img src='https://flagcdn.com/w20/us.png' style='width:16px; height:11px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:3px;'> Connor Hellebuyck
                    </td>
                    <td style="padding:2px; font-size:10px; text-align:center;">USA</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">1.00</td>
                    <td style="padding:2px; text-align:center; font-size:10px;">.944</td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div style="margin-top: auto; font-size: 12px; line-height: 1.4; color: #555; background: #fff; padding: 10px; border: 1px solid #eee;">
                <div style="margin-bottom:6px;"><b>The Verdict:</b> Milan 2026 marks the first "Best-on-Best" tournament in over a decade. While Canada remains the favorite, the gap has closed, with the USA and Sweden bringing perhaps their fastest rosters in Olympic history.</div>
                <div style="font-size:10px; color:#666;">Official game statistics can be found <a href="https://www.iihf.com/en/events/2026/olympic-m/tournamentinfo/officialdocuments" target="_blank" style="color:#2980b9; text-decoration:underline;">here</a>.</div>
            </div>
        </div>
    </div>

    <!-- Page 4: Rules + Canada Pic (New Order: 9,10) -->
    <div class="page">
        <div class="front panel" id="page-p_rules" style="padding: 15px; background: #fff;">
            <h2 style="margin-bottom: 4px;">Tournament Rules</h2>
            <div class="rules-main-list">
                <div class="rule-block">
                    <b>Fighting ejections</b>
                    <p>Automatic game misconduct and ejection. The IIHF Disciplinary Committee reviews all incidents for additional suspension.</p>
                </div>
                <div class="rule-block">
                    <b>The "Oshie" Shootout</b>
                    <p>Five initial shooters. After round five, a coach can choose the same player to shoot repeatedly as often as they desire.</p>
                </div>
                <div class="rule-block">
                    <b>Strict Crease Rule</b>
                    <p>If an attacker enters the crease even without contact, the referee may call a whistle and move the faceoff outside the zone.</p>
                </div>
                <div class="rule-block">
                    <b>Checks to the Head</b>
                    <p>In international play, checks to the head can be called as major penalties or game misconducts if the referee deems the play reckless.</p>
                </div>
            </div>
            <div class="three-up-row" style="display: flex; gap: 3px; margin-top: 2px;">
                <div class="ot-container" style="flex: 1;">
                    <h3>Point System</h3>
                    <ul style="margin:0; padding-left:16px; color:#222;">
                        <li><b>3 pts</b> for regulation win</li>
                        <li><b>2 pts</b> for OT/SO win</li>
                        <li><b>1 pt</b> for OT/SO loss</li>
                        <li><b>0 pts</b> for regulation loss</li>
                    </ul>
                </div>
                <div class="ot-container" style="flex: 1;">
                    <h3>Rosters</h3>
                    <ul style="margin:0; padding-left:16px; color:#222;">
                       <p> <b>22</b>  active players / match</p>
                         <p> <b>20 </b>skaters + <b>2 </b>goalies</p> 
                         <p> <b>NHL:</b> 20 max</b>, 18 F/D & 2 G</p> 
                         <p> Due<b> 1hr</b> before puck drop.</p>
                    </ul>
                </div>
                <div class="ot-container" style="flex: 1;">
                    <h3>Rink Dimensions</h3>
                    <p style="font-size: 10px; margin: 0 0 2px 0; color: #222;"><b style="font-size: 10.5px;">NHL:</b> 200 L Ã— 85 W ft.</p>
                    <p style="font-size: 10px; margin: 0 0 2px 0; color: #222;"><b style="font-size: 10.5px;">IIHF:</b> 197 L Ã— 98.5 W ft.</p>
                    <p style="font-size: 10px; margin: 0; color: #222;"><b style="font-size: 10.5px;">OLY:</b> 196.85 L Ã— 85.3 W ft.</p>
                </div>
            </div>
            <div style="display: flex; gap: 3px; margin-top: 2px;">
                <div class="ot-container" style="flex: 0 0 calc(50% - 1.5px);">
                    <h3>Overtime Formats</h3>
                    <div class="ot-sub-item"><b>Preliminary Round</b><p>5-minute 3-on-3 sudden death followed by a shootout.</p></div>
                    <div class="ot-sub-item"><b>Quarter/Semifinals</b><p>10-minute 3-on-3 sudden death followed by a shootout.</p></div>
                    <div class="ot-sub-item"><b>Gold Medal Game (No shootouts)</b><p>Unlimited 20-minute 3-on-3 periods until a winner scores.</p></div>
                </div>
                <div class="ot-container" style="flex: 0 0 calc(50% - 1.5px);">
                    <h3>Equipment</h3>
                    <div class="ot-sub-item"><b>Goalie Mask Designs</b><p>Need pre-approval from tournament officials.</p></div>
                    <div class="ot-sub-item"><b>Neck Guards</b><p>Mandatory for all players on the ice.</p></div>
                    <div class="ot-sub-item"><b>Sticks</b><p>Must be on market within last 6 months.</p></div>
                </div>
            </div>
            <div class="rules-footer" style="margin-top:auto;">
                Complete IIHF rulebook can be found <a href="https://blob.iihf.com/iihf-media/iihfmvc/media/contentimages/3_the_iihf/2025-26_iihf_rulebook_22122025-v1.pdf" target="_blank" style="color:#2980b9; text-decoration:underline;">here</a>.
            </div>
        </div>
        <div class="back panel" id="page-p6" style="padding:10px; background:#fff;">
            <img src="https://i0.wp.com/www.rawcharge.com/wp-content/uploads/sites/5/2025/12/team-canada-roster.jpg?resize=819%2C1024&ssl=1" style="width:100%; height:100%; object-fit:fill; border-radius:4px;">
        </div>
    </div>

    <!-- Page 5: Tina + Santagiulia (New Order: 11,12) -->
    <div class="page">
        <div class="front panel tina-layout" id="page-p2">
            <div class="tina-img-zone">
                <img src="https://i.postimg.cc/HnxSPprz/miss.png" alt="Tina Mascot">
            </div>
            <div class="tina-title-banner">
                <span class="tina-title-main">Meet Tina</span>
                <span class="tina-title-pipe">|</span>
                <span class="tina-title-sub">The Official Mascot</span>
            </div>
            <div class="tina-text-box">
                <div class="venue-desc" style="color:#444;">
                    Born in the Italian peaks and refined by the city, Tina is a dreamer on a mission. Explorer, guardian of nature, and believer that big dreams change the world. She knows that differences are an asset and respect is fundamental to growing up. From the snow-capped summits of Cortina to the urban sprawl of Milano, she is the creative spirit of the Games. Nature remains her true home, and she does everything in her power to protect it.
                </div>
            </div>
        </div>
        <div class="back panel page-layout-full" id="page-p3" style="padding:20px; background:#fff;">
            <img src="https://c.imggu.com/i/2026/02/12/7Fp1Y.png" class="bg-img" style="border-radius:4px;" alt="Santagiulia Collage">
            <!-- Removed header overlay, titles moved to footer -->
            <div class="text-bottom-overlay pos-giulia">
                <div class="venue-title-perf">
                    <span class="venue-main">Santagiulia</span>
                    <span class="divider">|</span>
                    <span class="venue-nick">Arena Italia</span>
                </div>
                <div class="venue-architect-perf">Architect: David Chipperfield</div>
                <!-- Description saved for later:
                <p class="desc-text-perf" style="font-size: 13px; line-height: 1.5;">The Santagiulia Arena is the high-tech cathedral for the gold medal quest. Its shimmering metallic rings echo the spiraling ramps of the legendary San Siro stadium, glowing with LED strips at night. Inside, the surface is crafted by legendary ice man Don Moffatt, providing a stage for 16,000 fans to witness the crowning of Olympic champions.</p>
                -->
            </div>
        </div>
    </div>

    <!-- Page 6: Rho Fiera + History (New Order: 13,14) -->
    <div class="page">
        <div class="front panel page-layout-full" id="page-p4" style="padding:20px; background:#fff;">
            <img src="https://b.imggu.com/i/2026/02/12/7FWCV.png" class="bg-img" style="border-radius:4px;" alt="Rho Fiera Collage">
            <!-- Removed header overlay, titles moved to footer -->
            <div class="text-bottom-overlay pos-rho">
                <div class="venue-title-perf">
                    <span class="venue-main">Rho Fiera</span>
                    <span class="divider">|</span>
                    <span class="venue-nick">Total Ice Park</span>
                </div>
                <div class="venue-architect-perf">Architect: Massimiliano Fuksas</div>
                <!-- Description saved for later:
                <p class="desc-text-perf" style="font-size: 13px; line-height: 1.5;">The Milano Ice Park is where the beauty of the sport meets the beast of architecture. The campus features a Speed Skating Stadium for 7,500 fans and a secondary Hockey Arena for 6,000. Under its sweeping glass roof, this landmark facility creates a high-performance environment where elegance and power collide.</p>
                -->
            </div>
        </div>
        <div class="back panel" id="page-p11">
            <h2>Olympic History</h2>
            <table class="medals-table">
                <thead><tr><th>Year</th><th>ðŸ¥‡ Gold</th><th>ðŸ¥ˆ Silver</th><th>ðŸ¥‰ Bronze</th></tr></thead>
                <tbody id="history-v"></tbody>
            </table>
            <div style="text-align: center; font-size: 10px; color: #333; line-height: 1.4; margin-top: 0; margin-bottom: 0; padding: 5px 7px; background: #fafafa; border: 1px solid #eee; border-radius: 2px;">
                List reflects when NHL players join Olympics circa 1998 | <span style="color: #c0392b;">*</span> NHL opts out 2018 & 2022
            </div>
            <div style="margin: 4px auto 0; width: 100%; padding: 8px; background: #fff; border-radius: 2px; box-sizing: border-box; overflow: hidden;">
              <img src="https://i.postimg.cc/xT5YsbQy/wq.png" style="width: calc(100% - 16px); display: block; margin: 0 auto;">
              <div style="text-align: center; font-size: 11px; color: #555; margin: 0 2px 9px 2px; padding: 4px 2px; font-style: italic; line-height:1.2; background: #f9f9f9; border-radius: 4px;">Dominik HaÅ¡ek holds his gold medal after shutting out Russia 1-0 in 1998. Nagano, Japan.</div>
            </div>
        </div>
    </div>

    <!-- Page 7: Notes + Back Cover -->
    <div class="page">
        <div class="front panel" id="page-p_outro" style="padding: 20px; background: #fff;">
            <h2 style="background: var(--header-bg); color: #fff; padding: 5px 10px; margin: -10px -10px 10px -10px;">Tournament Notes</h2>
            <div style="margin-top: 10px; font-size: 13px; color: #333; line-height: 1.6;">
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #2980b9;">
                    <strong>Group B 3-Way Tie (6 pts each):</strong><br>
                    Slovakia, Finland, Sweden tied at 6 pts. H2H circular (each beat one other). GD among tied: SVK +1, FIN 0, SWE -1. Result: 1. Slovakia, 2. Finland, 3. Sweden.
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #c0392b;">
                    <strong>Suspensions:</strong><br>
                    Italy's C. Digiacinto suspended 1 game (illegal check to head, Game #8 vs SVK, 2/13 2nd period, IIHF Rule 48).
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #f9f9f9; border-left: 3px solid #27ae60;">
                    <strong>Seeding Criteria:</strong><br>
                    1. Group position 2. Points 3. GD 4. GF 5. IIHF Ranking. Group tiebreaker: H2H first, then GD among tied.
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #fff7e6; border-left: 3px solid #b8860b;">
                    <strong>Disciplinary:</strong><br>
                    Canada's Tom Wilson and France's Pierre Crinon were ejected for fighting.
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: #fff7f7; border-left: 3px solid #8e44ad;">
                    <strong>Records:</strong><br>
                    Sydney Crosby becomes the record point holder among active Olympic players with 16 pts.
                </div>
            </div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="border-bottom: 1px solid #eee; height: 25px;"></div>
            <div style="margin-top: auto; font-size: 11px; color: #555; border-top: 1px solid #ddd; padding-top: 6px; background: #fafafa;">
                <strong>IIHF Resources:</strong><br>
                <a href="https://www.iihf.com/en/events/2026/olympic-m/tournamentinfo/68589/tournament_format" target="_blank" style="color:#2980b9;">Tournament Format</a> |
                <a href="https://blob.iihf.com/iihf-media/iihfmvc/media/contentimages/3_the_iihf/2025-26_iihf_rulebook_22122025-v1.pdf" target="_blank" style="color:#2980b9;">IIHF Rulebook (PDF)</a> |
                <a href="https://www.iihf.com/en/events/2026/olympic-m/gamedocs" target="_blank" style="color:#2980b9;">Official Game Documents</a>
            </div>
        </div>
        <div class="back cover" id="page-p12">
            <img src="back.png" class="bg-img" alt="Vintage hockey">
            <div class="back-overlay">
                <img src="ono.png" alt="ONO" style="width:120px; height:auto; opacity:0.85; margin-top:0px;">
                <div style="margin-top:auto;">
                    <div class="back-copyright">Â© 2026 ONO.flips</div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- Navigation Buttons -->
<div class="page-display" id="page-display">COVER</div>
<div class="page-controls-arcade" role="group" aria-label="Navigation Controls">
    <button class="push--prev push--flat" onclick="bookPrev()" title="Previous"></button>
    <button class="push--next push--flat" onclick="bookNext()" title="Next"></button>
</div>
<button class="push--menu push--flat" onclick="toggleMenu()" id="menu-toggle" title="Menu"></button>
<div class="menu-dropdown" id="menu-dropdown">
    <button class="menu-item" onclick="toggleFullscreen(); closeMenu();">â›¶ Fullscreen</button>
    <button class="menu-item" onclick="resetBook(); closeMenu();">âŸ² Reset</button>
    <button class="menu-item" onclick="bookGoTo(0); closeMenu();">â® First</button>
    <button class="menu-item" onclick="bookGoTo(99); closeMenu();">â­ Last</button>
</div>

<!-- Mobile Navigation Buttons -->
<button id="mobile-prev-btn" class="mobile-nav-btn mobile-prev push--flat" onclick="bookPrev()" type="button" title="Previous"></button>
<button id="mobile-next-btn" class="mobile-nav-btn mobile-next push--flat" onclick="bookNext()" type="button" title="Next"></button>

<!-- Navigation handled by CSS for mobile -->

<!-- Page turn sound -->
<audio id="pageTurn" preload="auto" src="PageFlip3.wav"></audio>

<script>
// Apply initial transform
window.addEventListener('DOMContentLoaded', () => {
    applyTransform();
});

function applyTransform() {
    const book = document.getElementById('hockey-book');
    if (book) {
        let baseTransform;
        const c = parseInt(book.style.getPropertyValue('--c') || '0');
        const totalPages = book.querySelectorAll('.page').length;
        
        if (c === 0) {
            // Front cover: page extends RIGHT of spine, shift left to center
            baseTransform = 'translateX(calc(var(--panel-width) / -2))';
        } else if (c >= totalPages) {
            // Back cover: page extends LEFT of spine, shift right to center
            baseTransform = 'translateX(calc(var(--panel-width) / 2))';
        } else {
            // Open book: spread visible, spine at center
            baseTransform = 'translateX(0)';
        }
        book.style.transform = baseTransform;
    }
}

// Menu toggle
window.toggleMenu = () => {
    const dropdown = document.getElementById('menu-dropdown');
    const toggle = document.getElementById('menu-toggle');
    if (dropdown && toggle) {
        dropdown.classList.toggle('show');
        toggle.classList.toggle('active');
    }
};

window.closeMenu = () => {
    const dropdown = document.getElementById('menu-dropdown');
    const toggle = document.getElementById('menu-toggle');
    if (dropdown && toggle) {
        dropdown.classList.remove('show');
        toggle.classList.remove('active');
    }
};



// Fullscreen toggle
window.toggleFullscreen = () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(() => {});
    } else {
        document.exitFullscreen().catch(() => {});
    }
};

document.addEventListener('fullscreenchange', () => {
    applyTransform();
});

// Reset to first page
window.resetBook = () => {
    if (window.bookGoTo) window.bookGoTo(0);
    applyTransform();
};

// Prevent image dragging
document.addEventListener('dragstart', (e) => {
    if (e.target.tagName === 'IMG') {
        e.preventDefault();
    }
});

// Page flip on edge click
document.addEventListener('click', (e) => {
    const panel = e.target.closest('.front, .back');
    if (panel) {
        const rect = panel.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const edgeWidth = rect.width * 0.35; // 35% on each side
        
        const isFront = panel.classList.contains('front');
        const isBack = panel.classList.contains('back');
        
        if (isFront && x > rect.width - edgeWidth) {
            if (window.bookNext) window.bookNext();
        } else if (isBack && x < edgeWidth) {
            if (window.bookPrev) window.bookPrev();
        }
    }
});

// Hover effect on edges
document.addEventListener('mousemove', (e) => {
    const panel = e.target.closest('.front, .back');
    document.querySelectorAll('.page-flip-zone').forEach(z => {
        z.style.background = '';
        z.style.boxShadow = '';
    });
    
    if (panel) {
        const rect = panel.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const edgeWidth = rect.width * 0.35;
        const isFront = panel.classList.contains('front');
        const isBack = panel.classList.contains('back');
        
        if (isFront && x > rect.width - edgeWidth) {
            const zone = panel.querySelector('.page-flip-right');
            if (zone) {
                zone.style.background = 'linear-gradient(to left, rgba(0, 0, 0, 0.3), transparent)';
                zone.style.boxShadow = '';
                document.body.style.cursor = 'pointer';
            }
        } else if (isBack && x < edgeWidth) {
            const zone = panel.querySelector('.page-flip-left');
            if (zone) {
                zone.style.background = 'linear-gradient(to right, rgba(0, 0, 0, 0.3), transparent)';
                zone.style.boxShadow = '';
                document.body.style.cursor = 'pointer';
            }
        } else {
            document.body.style.cursor = '';
        }
    } else {
        document.body.style.cursor = '';
    }
});

// Flipbook engine
const flipBook = (elBook) => {
    const pages = Array.from(elBook.querySelectorAll(".page"));
    let current = 0;

    const updatePageDisplay = () => {
        const display = document.getElementById('page-display');
        if (!display) return;
        if (current === 0) {
            display.textContent = 'COVER';
        } else if (current >= pages.length) {
            display.textContent = 'BACK';
        } else {
            const leftPage = current * 2;
            const rightPage = leftPage + 1;
            display.textContent = leftPage + ' | ' + rightPage;
        }
    };

    const playPageSound = () => {
        const audio = document.getElementById('pageTurn');
        if (audio) {
            audio.currentTime = 0;
            audio.volume = 0.6;
            audio.play().catch(() => {});
        }
    };

    const setCurrent = (c) => {
        current = Math.max(0, Math.min(c, pages.length));
        elBook.style.setProperty("--c", current);
        applyTransform();
        updatePageDisplay();
        playPageSound();
    };

    const createZone = (side) => {
        const zone = document.createElement('div');
        zone.className = `page-flip-zone page-flip-${side}`;
        return zone;
    };

    pages.forEach((page, idx) => {
        page.style.setProperty("--i", idx);
        
        // Add visual hover zones on edges (click handled by mouseup)
        const frontPanel = page.querySelector('.front');
        if (frontPanel) {
            frontPanel.style.position = 'relative';
            frontPanel.appendChild(createZone('right'));
        }
        
        const backPanel = page.querySelector('.back');
        if (backPanel) {
            backPanel.style.position = 'relative';
            backPanel.appendChild(createZone('left'));
        }
    });

    setCurrent(0);

    // Expose for buttons
    window.bookNext = () => {
        if (window.isPortraitMobile && window.isPortraitMobile()) {
            const panels = Array.from(elBook.querySelectorAll('.front, .back'));
            if (!panels.length) return;
            const vc = window.innerWidth / 2;
            let ci = 0, md = Infinity;
            panels.forEach((p, i) => { const r = p.getBoundingClientRect(); const d = Math.abs(r.left + r.width/2 - vc); if (d < md) { md = d; ci = i; } });
            window.mobileIndex = ci;
            if (window.mobileIndex < panels.length - 1) {
                window.mobileIndex++;
                panels[window.mobileIndex].scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
            }
            return;
        }
        setCurrent(current + 1);
    };
    window.bookPrev = () => {
        if (window.isPortraitMobile && window.isPortraitMobile()) {
            const panels = Array.from(elBook.querySelectorAll('.front, .back'));
            if (!panels.length) return;
            const vc = window.innerWidth / 2;
            let ci = 0, md = Infinity;
            panels.forEach((p, i) => { const r = p.getBoundingClientRect(); const d = Math.abs(r.left + r.width/2 - vc); if (d < md) { md = d; ci = i; } });
            window.mobileIndex = ci;
            if (window.mobileIndex > 0) {
                window.mobileIndex--;
                panels[window.mobileIndex].scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
            }
            return;
        }
        setCurrent(current - 1);
    };
    window.bookGoTo = (c) => setCurrent(c);
    window.isPortraitMobile = () => window.innerWidth <= 900 && window.matchMedia('(orientation: portrait)').matches;
    window.mobileIndex = 0;
};

document.querySelectorAll(".book").forEach(flipBook);

// Mobile CSS handles formatting automatically via breakpoints
// Regular flipbook navigation works on all screen sizes

// Inline data (fallback if fetch fails - works with file:// protocol)
window.HockeyData = {
    "flagMap": {
        "Canada": "ca", "Czechia": "cz", "Switzerland": "ch", "France": "fr",
        "Finland": "fi", "Sweden": "se", "Slovakia": "sk", "Italy": "it",
        "USA": "us", "Germany": "de", "Latvia": "lv", "Denmark": "dk"
    },
    "storedScores": {
        "p1-h": "4", "p1-a": "1", "p2-h": "5", "p2-a": "2",
        "p3-h": "4", "p3-a": "0", "p4-a": "5", "p4-h": "0",
        "p5-a": "5", "p5-h": "1", "p6-h": "3", "p6-a": "1",
        "p7-h": "4", "p7-a": "1", "p8-h": "2", "p8-a": "3",
        "p9-h": "3", "p9-a": "6", "p10-h": "5", "p10-a": "1",
        "p11-h": "5", "p11-a": "3", "p12-h": "3", "p12-a": "4",
        "p13-h": "11", "p13-a": "0", "p14-h": "6", "p14-a": "3",
        "p15-h": "4", "p15-a": "3*", "p16-h": "10", "p16-a": "2",
        "p17-h": "4", "p17-a": "2", "p18-h": "5", "p18-a": "1"
    },
    "storedESPNStats": {
        "scorers": [
            {"rank": "1.", "name": "Connor McDavid", "team": "CAN", "gp": "3", "goals": "2", "assists": "7", "points": "9"},
            {"rank": "2.", "name": "Macklin Celebrini", "team": "CAN", "gp": "3", "goals": "4", "assists": "2", "points": "6"},
            {"rank": "3.", "name": "Juraj Slafkovsky", "team": "SVK", "gp": "3", "goals": "3", "assists": "3", "points": "6"},
            {"rank": "4.", "name": "Sidney Crosby", "team": "CAN", "gp": "3", "goals": "2", "assists": "4", "points": "6"},
            {"rank": "5.", "name": "Nathan MacKinnon", "team": "CAN", "gp": "3", "goals": "2", "assists": "3", "points": "5"}
        ],
        "goalies": [
            {"rank": "1.", "name": "Logan Thompson", "team": "CAN", "gp": "1", "wins": "1", "gaa": "1.00", "svp": ".960"},
            {"rank": "2.", "name": "Jordan Binnington", "team": "CAN", "gp": "2", "wins": "2", "gaa": "1.00", "svp": ".950"},
            {"rank": "3.", "name": "Leonardo Genoni", "team": "SUI", "gp": "2", "wins": "2", "gaa": "1.48", "svp": ".949"},
            {"rank": "4.", "name": "Juuse Saros", "team": "FIN", "gp": "3", "wins": "2", "gaa": "1.34", "svp": ".946"},
            {"rank": "5.", "name": "Connor Hellebuyck", "team": "USA", "gp": "1", "wins": "1", "gaa": "1.00", "svp": ".944"}
        ],
        "lastFetch": "2026-02-14T22:30:16.228Z"
    },
    "prelims": [
        { "id": "p1", "g": "B", "d": "Wed Feb 11", "t": "10:40a", "h": "Slovakia", "a": "Finland", "v": "R" },
        { "id": "p2", "g": "B", "d": "Wed Feb 11", "t": "03:10p", "h": "Sweden", "a": "Italy", "v": "S" },
        { "id": "p3", "g": "A", "d": "Thu Feb 12", "t": "06:10a", "h": "Switzerland", "a": "France", "v": "R" },
        { "id": "p4", "g": "A", "d": "Thu Feb 12", "t": "10:40a", "h": "Czechia", "a": "Canada", "v": "S" },
        { "id": "p5", "g": "C", "d": "Thu Feb 12", "t": "03:10p", "h": "Latvia", "a": "USA", "v": "R" },
        { "id": "p6", "g": "C", "d": "Thu Feb 12", "t": "03:10p", "h": "Germany", "a": "Denmark", "v": "R" },
        { "id": "p7", "g": "B", "d": "Fri Feb 13", "t": "06:10a", "h": "Finland", "a": "Sweden", "v": "S" },
        { "id": "p8", "g": "B", "d": "Fri Feb 13", "t": "06:10a", "h": "Italy", "a": "Slovakia", "v": "R" },
        { "id": "p9", "g": "A", "d": "Fri Feb 13", "t": "10:40a", "h": "France", "a": "Czechia", "v": "R" },
        { "id": "p10", "g": "A", "d": "Fri Feb 13", "t": "03:10p", "h": "Canada", "a": "Switzerland", "v": "S" },
        { "id": "p11", "g": "B", "d": "Sat Feb 14", "t": "06:10a", "h": "Sweden", "a": "Slovakia", "v": "R" },
        { "id": "p12", "g": "C", "d": "Sat Feb 14", "t": "06:10a", "h": "Germany", "a": "Latvia", "v": "S" },
        { "id": "p13", "g": "B", "d": "Sat Feb 14", "t": "10:40a", "h": "Finland", "a": "Italy", "v": "R" },
        { "id": "p14", "g": "C", "d": "Sat Feb 14", "t": "03:10p", "h": "USA", "a": "Denmark", "v": "S" },
        { "id": "p15", "g": "A", "d": "Sun Feb 15", "t": "06:10a", "h": "Switzerland", "a": "Czechia", "v": "S" },
        { "id": "p16", "g": "A", "d": "Sun Feb 15", "t": "10:40a", "h": "Canada", "a": "France", "v": "R" },
        { "id": "p17", "g": "C", "d": "Sun Feb 15", "t": "01:10p", "h": "Denmark", "a": "Latvia", "v": "R" },
        { "id": "p18", "g": "C", "d": "Sun Feb 15", "t": "03:10p", "h": "USA", "a": "Germany", "v": "S" }
    ],
    "knockouts": [
        { "header": "QUALIFICATION ROUND" },
        { "id": "k1", "g": "Q", "d": "Tue Feb 17", "t": "06:10a", "h": "Germany", "a": "Denmark", "v": "R" },
        { "id": "k2", "g": "Q", "d": "Tue Feb 17", "t": "10:40a", "h": "Sweden", "a": "Italy", "v": "S" },
        { "id": "k3", "g": "Q", "d": "Tue Feb 17", "t": "12:10p", "h": "Switzerland", "a": "France", "v": "R" },
        { "id": "k4", "g": "Q", "d": "Tue Feb 17", "t": "03:10p", "h": "Czechia", "a": "Latvia", "v": "S" },
        { "header": "QUARTERFINALS" },
        { "id": "k5", "g": "QF", "d": "Wed Feb 18", "t": "10:40a", "h": "Canada", "a": "Reseed 4", "v": "S" },
        { "id": "k6", "g": "QF", "d": "Wed Feb 18", "t": "10:40a", "h": "USA", "a": "Reseed 3", "v": "R" },
        { "id": "k7", "g": "QF", "d": "Wed Feb 18", "t": "03:10p", "h": "Slovakia", "a": "Reseed 2", "v": "S" },
        { "id": "k8", "g": "QF", "d": "Wed Feb 18", "t": "03:10p", "h": "Finland", "a": "Reseed 1", "v": "R" },
        { "header": "SEMIFINALS" },
        { "id": "k9", "g": "SF", "d": "Fri Feb 20", "t": "10:40a", "h": "Win QF", "a": "Win QF", "v": "S" },
        { "id": "k10", "g": "SF", "d": "Fri Feb 20", "t": "03:10p", "h": "Win QF", "a": "Win QF", "v": "S" },
        { "header": "MEDAL GAMES" },
        { "id": "k11", "g": "ðŸ¥‰", "d": "Sat Feb 21", "t": "02:40p", "h": "Lose SF1", "a": "Lose SF2", "v": "S" },
        { "id": "k12", "g": "ðŸ¥‡ðŸ¥ˆ", "d": "Sun Feb 22", "t": "08:10a", "h": "Win SF1", "a": "Win SF2", "v": "S" }
    ],
    "historyData": [
        ["2022", "fi", "FIN", "ru", "ROC", "sk", "SVK"],
        ["2018", "ru", "OAR", "de", "GER", "ca", "CAN"],
        ["2014", "ca", "CAN", "se", "SWE", "fi", "FIN"],
        ["2010", "ca", "CAN", "us", "USA", "fi", "FIN"],
        ["2006", "se", "SWE", "fi", "FIN", "cz", "CZE"],
        ["2002", "ca", "CAN", "us", "USA", "ru", "RUS"],
        ["1998", "cz", "CZE", "ru", "RUS", "fi", "FIN"]
    ],
    "teamGroups": {
        "Canada": "A", "Czechia": "A", "Switzerland": "A", "France": "A",
        "Finland": "B", "Sweden": "B", "Slovakia": "B", "Italy": "B",
        "USA": "C", "Germany": "C", "Latvia": "C", "Denmark": "C"
    }
};

// Helper function for group colors
const getGrpColor = (grp) => grp === 'A' ? '#c0392b' : grp === 'B' ? '#2980b9' : grp === 'C' ? '#27ae60' : 'inherit';

// Initialize tables after DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    // Load data from data.json and then initialize
    fetch('data.json')
        .then(response => response.json())
        .then(jsonData => {
            // Merge JSON data with inline data
            if (jsonData.storedScores) {
                window.HockeyData.storedScores = Object.assign({}, window.HockeyData.storedScores, jsonData.storedScores);
            }
            if (jsonData.storedESPNStats) {
                window.HockeyData.storedESPNStats = jsonData.storedESPNStats;
            }
            // Initialize after loading data
            injectTables();
            updateStandings();
        })
        .catch(err => {
            console.log('Using inline data (data.json not loaded):', err);
            // Fallback to inline data - already set
            injectTables();
            updateStandings();
        });
});

function injectTables() {
    const data = window.HockeyData || {};
    const prelims = data.prelims || [];
    const knockouts = data.knockouts || [];
    const historyData = data.historyData || [];
    const storedScores = data.storedScores || {};
    const flagMap = data.flagMap || {};

    const getFlagImgBuzz = (name) => {
        let code = null;
        for (const key in flagMap) {
            if (name.indexOf(key) !== -1) { code = flagMap[key]; break; }
        }
        if (!code) return '';
        return '<img src="https://flagcdn.com/w20/' + code + '.png" style="width:16px; height:11px; vertical-align:-1px; margin:0 2px;">';
    };
    const getFlagImg = (name) => {
        let code = null;
        for (const key in flagMap) {
            if (name.indexOf(key) !== -1) { code = flagMap[key]; break; }
        }
        if (!code) return ''; // No flag for placeholders like "Reseed 1", "Win QF", etc.
        return '<img src="https://flagcdn.com/w20/' + code + '.png" style="width:16px; height:11px; vertical-align:-1px; margin:0 -16px;">';
    };
    // Highlight 'Reseed N' substrings so we can style them
    const highlightReseed = (s) => {
        if (!s) return s;
        // Wrap only the number in a reseed span: 'Reseed 4' => 'Reseed <span class="reseed">4</span>'
        return s.replace(/Reseed\s*(\d+)/ig, function(_, p1) { return 'Reseed ' + '<span class="reseed">' + p1 + '</span>'; });
    };
    
    // Helper to format team name appropriately for knockouts
    const formatKOTeam = (name) => {
        return name; // Just return name, flags handled separately
    };
    
    // Helper to get flag code for knockout teams
    const getKOFlag = (name) => {
        for (const key in flagMap) {
            if (name.indexOf(key) !== -1) return flagMap[key];
        }
        return null;
    };

    // Preliminaries with editable score boxes
    const pBody = document.getElementById('sched-prelims-v');
    if (pBody) {
        pBody.innerHTML = '';
        prelims.forEach(g => {
            const tr = document.createElement('tr');
            tr.innerHTML = '<td class="c-grp" style="padding:5px 8px; color:' + getGrpColor(g.g) + '">' + g.g + '</td>' +
                '<td class="c-ven" style="padding:5px 8px;">' + g.v + '</td>' +
                '<td class="c-date" style="padding:5px 8px;">' + g.d + '</td>' +
                '<td class="c-time" style="padding:5px 8px;">' + g.t + '</td>' +
                '<td class="c-match" style="padding:5px 8px;">' +
                    '<span class="team-home" style="display:inline-flex; align-items:center; width:60px; justify-content:flex-start;"><span style="display:inline-block; width:18px; text-align:center; vertical-align:middle;">' + getFlagImg(g.h) + '</span><span style="text-align:right; padding-right:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; flex:1;">' + g.h.substring(0,3).toUpperCase() + '</span></span>' +
                    '<span class="score-area" style="display:inline-flex; align-items:center; width:44px; justify-content:center; margin:0 6px;">' +
                        '<span class="sb" contenteditable="true" data-key="' + g.id + '-h">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                        '<span class="sb" contenteditable="true" data-key="' + g.id + '-a">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                    '</span>' +
                    '<span class="team-away" style="display:inline-flex; align-items:center; width:60px; justify-content:flex-end;"><span style="text-align:left; padding-left:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; flex:1;">' + g.a.substring(0,3).toUpperCase() + '</span><span style="display:inline-block; width:18px; text-align:center; vertical-align:middle;">' + getFlagImg(g.a) + '</span></span>' +
                '</td>';
            pBody.appendChild(tr);
        });
    }

    // Knockouts with editable score boxes (skip qualification round - shown separately)
    const kBody = document.getElementById('sched-ko-v');
    if (kBody) {
        kBody.innerHTML = '';
        // Filter out the qualification header from the knockout rendering
        knockouts.filter(g => !g.header || g.header !== 'QUALIFICATION ROUND').forEach(g => {
            if (g.g === 'Q') return; // Skip qualification games
            if (g.header === 'MEDAL GAMES') return; // do not render the generic medal games header
            const tr = document.createElement('tr');
            if (g.header) {
                // If we're about to render Quarterfinals, add the dynamic quote above it
                if (g.header === 'QUARTERFINALS') {
                    const quoteRow = document.createElement('tr');
                    const dynamicQuote = window.getTournamentQuote ? window.getTournamentQuote('QUARTERFINALS') : 'And then there were eight..';
                    quoteRow.innerHTML = '<td colspan="7" class="ko-quote" style="background:transparent; text-align:center; padding:6px 0; font-size:16px;">' + dynamicQuote + '</td>';
                    kBody.appendChild(quoteRow);
                    // spacer to give extra gap above the Quarterfinals header
                    const spacer = document.createElement('tr');
                    spacer.innerHTML = '<td colspan="7" style="background:transparent; height:10px; line-height:10px;">&nbsp;</td>';
                    kBody.appendChild(spacer);
                }
                
                // Add quotes for other stages
                if (g.header === 'SEMIFINALS') {
                    // No quote for semifinals - just spacer
                    const spacer = document.createElement('tr');
                    spacer.innerHTML = '<td colspan="7" style="background:transparent; height:10px; line-height:10px;">&nbsp;</td>';
                    kBody.appendChild(spacer);
                }
                tr.innerHTML = '<td colspan="7" style="background:#f4f4f4; text-align:center; font-weight:900; font-size:12px; border-bottom:1px solid #000; padding:4px 0;">' + g.header + '</td>';
            } else {
                // Insert separate headers for Bronze and Gold medal games
                if (g.id === 'k11') {
                    const bronzeHeader = document.createElement('tr');
                    bronzeHeader.innerHTML = '<td colspan="7"><div class="medal-header bronze"><span class="medal-title">BRONZE MEDAL GAME</span></div></td>';
                    kBody.appendChild(bronzeHeader);
                    // small spacer below bronze header
                    const spacerBelowBronze = document.createElement('tr');
                    spacerBelowBronze.innerHTML = '<td colspan="7" style="background:transparent; height:2px; line-height:2px;">&nbsp;</td>';
                    kBody.appendChild(spacerBelowBronze);
                }
                if (g.id === 'k12') {
                    // small spacer above gold header
                    const spacerAboveGold = document.createElement('tr');
                    spacerAboveGold.innerHTML = '<td colspan="7" style="background:transparent; height:8px; line-height:8px;">&nbsp;</td>';
                    kBody.appendChild(spacerAboveGold);
                    const goldHeader = document.createElement('tr');
                    goldHeader.innerHTML = '<td colspan="7"><div class="medal-header gold"><span class="medal-title">GOLD MEDAL MATCH</span></div></td>';
                    kBody.appendChild(goldHeader);
                    // add larger spacer below the gold header to lower the match row and prevent scrunching
                    const spacerBelowGoldHeader = document.createElement('tr');
                    spacerBelowGoldHeader.innerHTML = '<td colspan="7" style="background:transparent; height:16px; line-height:16px;">&nbsp;</td>';
                    kBody.appendChild(spacerBelowGoldHeader);
                }

                var homeFlag = getKOFlag(g.h) ? '<img src="https://flagcdn.com/w20/' + getKOFlag(g.h) + '.png" style="width:16px; height:11px; vertical-align:-1px;">' : '';
                var awayFlag = getKOFlag(g.a) ? '<img src="https://flagcdn.com/w20/' + getKOFlag(g.a) + '.png" style="width:16px; height:11px; vertical-align:-1px;">' : '';
                const homeLabel = highlightReseed(formatKOTeam(g.h));
                const awayLabel = highlightReseed(formatKOTeam(g.a));

                tr.innerHTML = '<td class="c-grp" style="padding:6px 2px;">' + g.g + '</td>' +
                    '<td class="c-ven" style="padding:6px 5px;">' + g.v + '</td>' +
                    '<td class="c-date" style="padding:6px 5px;">' + g.d + '</td>' +
                    '<td class="c-time" style="padding:6px 5px;">' + g.t + '</td>' +
                    // Qualification-style flags: left flag cell (right-aligned), match cell, right flag cell (left-aligned)
                    '<td class="c-flag" style="padding:6px 6px 6px 8px; text-align:right; width:22px;">' + (homeFlag ? homeFlag : '') + '</td>' +
                    '<td class="c-match" style="padding:6px 4px; text-align:center;">' +
                        '<span style="display:inline-block; min-width:64px; text-align:right; padding-right:4px;">' + homeLabel + '</span>' +
                        '<span class="score-area" style="display:inline-block; width:36px;">' +
                            '<span class="sb" contenteditable="true" data-key="' + g.id + '-h">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                            '<span class="sb" contenteditable="true" data-key="' + g.id + '-a">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                        '</span>' +
                        '<span style="display:inline-block; min-width:64px; text-align:left; padding-left:4px;">' + awayLabel + '</span>' +
                    '</td>' +
                    '<td class="c-flag" style="padding:6px 2px 6px 3px; text-align:left; width:22px;">' + (awayFlag ? awayFlag : '') + '</td>';
            }
            kBody.appendChild(tr);
        });
    }

    // Qualification Round games on seeding page - now handled in updateSeeds()
    // This will be populated with actual team names after standings are computed

    // History
    const hBody = document.getElementById('history-v');
    if (hBody) {
        hBody.innerHTML = '';
        historyData.forEach(r => {
            hBody.innerHTML += '<tr><td>' + r[0] + '</td><td><img src="https://flagcdn.com/w20/' + r[1] + '.png" style="width:14px;"> ' + r[2] + '</td>' +
                '<td><img src="https://flagcdn.com/w20/' + r[3] + '.png" style="width:14px;"> ' + r[4] + '</td>' +
                '<td><img src="https://flagcdn.com/w20/' + r[5] + '.png" style="width:14px;"> ' + r[6] + '</td></tr>';
        });
    }

    // Daily buzz - grouped date rendering (Yesterday / Today / Tomorrow + NEXT GAME DAY)
    const now = new Date();
    now.setHours(0,0,0,0);
    const year = new Date().getFullYear();

    const parseDataDate = (s) => {
        if (!s) return null;
        const m = s.match(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+(\d{1,2})/i);
        if (!m) return null;
        const mon = m[1].slice(0,1).toUpperCase() + m[1].slice(1).toLowerCase();
        const day = parseInt(m[2], 10);
        const monthMap = { Jan:0, Feb:1, Mar:2, Apr:3, May:4, Jun:5, Jul:6, Aug:7, Sep:8, Oct:9, Nov:10, Dec:11 };
        return new Date(year, monthMap[mon], day);
    };

    const formatDateKey = (d) => {
        return new Intl.DateTimeFormat('en-US', { weekday: 'short', month: 'short', day: 'numeric' }).format(d).replace(/,\s*/g, ' ');
    };

    // Combine prelims + knockouts into schedule
    const schedule = [];
    (prelims || []).forEach(p => schedule.push(p));
    (knockouts || []).forEach(k => { if (k && k.id) schedule.push(k); });

    // Group games by formatted date key
    const byDate = {};
    schedule.forEach(g => {
        const dt = parseDataDate(g.d);
        if (!dt) return;
        const key = formatDateKey(dt);
        if (!byDate[key]) byDate[key] = [];
        byDate[key].push(g);
    });

    const todayKey = formatDateKey(now);
    const yesterdayDate = new Date(now); yesterdayDate.setDate(now.getDate() - 1);
    const tomorrowDate = new Date(now); tomorrowDate.setDate(now.getDate() + 1);
    const yesterdayKey = formatDateKey(yesterdayDate);
    const tomorrowKey = formatDateKey(tomorrowDate);

    // Update title
    const buzzTitle = document.querySelector('#page-p5 h2');
    if (buzzTitle) buzzTitle.textContent = 'Daily Buzz: ' + todayKey;

    // Row styles
    const buzzRowStyle = 'display:flex; align-items:center; font-size:13px; font-weight:bold; padding:4px 0;';
    const grpColStyle = 'width:16px; text-align:center; font-weight:900; margin-right:2px; font-size:12px;';
    const venColStyle = 'width:14px; text-align:center; margin-right:2px; font-size:12px; color:#888;';
    const timeColStyle = 'width:62px; text-align:center; font-weight:900; margin-right:4px; font-size:12px;';
    const scoreBoxStyle = 'margin:0 3px; background:#000; color:#fff; padding:3px 6px; border-radius:3px; min-width:38px; text-align:center; font-size:13px;';

    const renderBuzzList = (container, key, mode) => {
        if (!container) return;
        container.innerHTML = '';
        const list = byDate[key] || [];
        if (!list.length) {
            const isYesterday = (key === yesterdayKey);
            const dbColor = isYesterday ? '#999' : '#800000';
            const dbSize = isYesterday ? '12px' : '15px';
            const dbPad = isYesterday ? '6px 0' : '10px 0';
            container.innerHTML = '<div style="text-align:center; color:' + dbColor + '; font-size:' + dbSize + '; padding:' + dbPad + '; margin:8px 0 6px 0; font-weight:800;">DAY BREAK - NO GAMES</div>';
            // If this is today's day break, show the Women's Semifinals note below
            if (key === todayKey) {
                container.innerHTML += '<div style="text-align:center; font-size:11px; font-weight:700; color:#333; margin-top:-4px; margin-bottom:4px;">WOMAN\'S SEMI-FINALS</div>';
                container.innerHTML += '<div style="display:flex; flex-direction:row; gap:18px; justify-content:center; align-items:center; font-size:12px; color:#222; margin-bottom:6px;">' +
                    '<div>USA vs SWE â€” 10:40a</div>' +
                    '<div style="opacity:0.6;">â€¢</div>' +
                    '<div>CAN vs SWI â€” 3:10p</div>' +
                '</div>';
            }
            return;
        }
        list.forEach(m => {
            const hKey = m.id + '-h';
            const aKey = m.id + '-a';
            const homeScore = (storedScores && storedScores[hKey]) || '';
            const awayScore = (storedScores && storedScores[aKey]) || '';
            const hasScore = storedScores && storedScores.hasOwnProperty(hKey) && storedScores.hasOwnProperty(aKey) && homeScore !== '' && awayScore !== '' && !(homeScore === '0' && awayScore === '0');

            if (mode === 'past' || hasScore) {
                // final
                container.innerHTML += '<div style="' + buzzRowStyle + '">' +
                    '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                    '<span style="' + venColStyle + '">' + m.v + '</span>' +
                    '<span style="' + timeColStyle + 'color:#c0392b;">F</span>' +
                    '<span style="flex:1; display:flex; align-items:center; padding-right:1px;">' +
                        '<span style="display:inline-block; width:16px; text-align:left; margin-right:1px;">' + getFlagImgBuzz(m.h) + '</span>' +
                        '<span style="flex:1; text-align:right; padding-right:6px;">' + m.h + '</span>' +
                    '</span>' +
                    '<span style="' + scoreBoxStyle + '">' + (homeScore || '-') + '-' + (awayScore || '-') + '</span>' +
                    '<span style="flex:1; display:flex; align-items:center; padding-left:1px;">' +
                        '<span style="flex:1; text-align:left; padding-left:6px;">' + m.a + '</span>' +
                        '<span style="display:inline-block; width:16px; text-align:right; margin-left:1px; margin-right:8px;">' + getFlagImgBuzz(m.a) + '</span>' +
                    '</span>' +
                '</div>';
            } else {
                // upcoming
                container.innerHTML += '<div style="' + buzzRowStyle + '">' +
                    '<span style="' + grpColStyle + 'color:' + getGrpColor(m.g) + ';">' + m.g + '</span>' +
                    '<span style="' + venColStyle + '">' + m.v + '</span>' +
                    '<span style="' + timeColStyle + 'color:#2980b9;">' + (m.t || '') + '</span>' +
                    '<span style="flex:1; display:flex; align-items:center; padding-right:1px;">' +
                        '<span style="display:inline-block; width:16px; text-align:left; margin-right:1px;">' + getFlagImgBuzz(m.h) + '</span>' +
                        '<span style="flex:1; text-align:right; padding-right:6px;">' + m.h + '</span>' +
                    '</span>' +
                    '<span style="' + scoreBoxStyle + 'background:#f0f0f0; color:#666;">vs</span>' +
                    '<span style="flex:1; display:flex; align-items:center; padding-left:1px;">' +
                        '<span style="flex:1; text-align:left; padding-left:6px;">' + m.a + '</span>' +
                        '<span style="display:inline-block; width:16px; text-align:right; margin-left:1px; margin-right:8px;">' + getFlagImgBuzz(m.a) + '</span>' +
                    '</span>' +
                '</div>';
            }
        });
    };

    // Fill containers
    const yBuzz = document.getElementById('yesterday-buzz-v');
    renderBuzzList(yBuzz, yesterdayKey, 'past');
    const tBuzz = document.getElementById('today-buzz-v');
    renderBuzzList(tBuzz, todayKey, 'mixed');
    const tmBuzz = document.getElementById('tomorrow-buzz-v');
    renderBuzzList(tmBuzz, tomorrowKey, 'upcoming');

    // (NEXT GAME DAY summary removed - showing only Yesterday/Today/Tomorrow)

    // Display-only: remove contenteditable from score boxes
    document.querySelectorAll('.sb').forEach(el => {
        el.removeAttribute('contenteditable');
    });
}

// H2H Tiebreaker Functions
function getH2HResults(teams, prelims, storedScores) {
    const h2h = {};
    teams.forEach(t => { h2h[t] = { p: 0, gf: 0, ga: 0 }; });
    prelims.forEach(g => {
        if (!teams.includes(g.h) || !teams.includes(g.a)) return;
        const hRaw = (storedScores[g.id + '-h'] || '').toString().toLowerCase();
        const aRaw = (storedScores[g.id + '-a'] || '').toString().toLowerCase();
        if (!hRaw || !aRaw || isNaN(parseInt(hRaw)) || isNaN(parseInt(aRaw))) return;
        const hScore = parseInt(hRaw); const aScore = parseInt(aRaw);
        const isOT = hRaw.includes('*') || aRaw.includes('*') || hRaw.includes('t') || aRaw.includes('t');
        h2h[g.h].gf += hScore; h2h[g.h].ga += aScore;
        h2h[g.a].gf += aScore; h2h[g.a].ga += hScore;
        if (hScore > aScore) {
            if (isOT) { h2h[g.h].p += 2; h2h[g.a].p += 1; }
            else { h2h[g.h].p += 3; }
        } else if (aScore > hScore) {
            if (isOT) { h2h[g.a].p += 2; h2h[g.h].p += 1; }
            else { h2h[g.a].p += 3; }
        }
    });
    return h2h;
}

function sortTeamsWithTiebreaker(teams, results, prelims, storedScores) {
    // First sort by points and GD
    teams.sort((a, b) => results[b].p - results[a].p || (results[b].gf - results[b].ga) - (results[a].gf - results[a].ga));
    
    // Find groups of tied teams (same points)
    const sorted = [];
    let i = 0;
    while (i < teams.length) {
        const tiedGroup = [teams[i]];
        let j = i + 1;
        while (j < teams.length && results[teams[j]].p === results[teams[i]].p) {
            tiedGroup.push(teams[j]);
            j++;
        }
        if (tiedGroup.length > 1) {
            // Apply H2H tiebreaker
            const h2h = getH2HResults(tiedGroup, prelims, storedScores);
            tiedGroup.sort((a, b) => h2h[b].p - h2h[a].p || (h2h[b].gf - h2h[b].ga) - (h2h[a].gf - h2h[a].ga) || (results[b].gf - results[b].ga) - (results[a].gf - results[a].ga));
        }
        sorted.push(...tiedGroup);
        i = j;
    }
    return sorted;
}

// Store scores in memory
let storedScoresLocal = {};

function updateStandings() {
    const data = window.HockeyData || {};
    const prelims = data.prelims || [];
    const storedScores = Object.assign({}, data.storedScores || {}, storedScoresLocal);
    const flagMap = data.flagMap || {};
    const teamGroups = data.teamGroups || {};

    const results = {};
    Object.keys(teamGroups).forEach(team => { results[team] = { w:0, otw:0, otl:0, l:0, gf:0, ga:0, gd:0, p:0 }; });
    prelims.forEach(g => {
        const hRaw = (storedScores[g.id + '-h'] || '').toString().toLowerCase();
        const aRaw = (storedScores[g.id + '-a'] || '').toString().toLowerCase();
        if (!hRaw || !aRaw || isNaN(parseInt(hRaw)) || isNaN(parseInt(aRaw))) return;
        const hScore = parseInt(hRaw); const aScore = parseInt(aRaw);
        const isOT = hRaw.includes('*') || aRaw.includes('*') || hRaw.includes('t') || aRaw.includes('t');
        results[g.h].gf += hScore; results[g.h].ga += aScore;
        results[g.a].gf += aScore; results[g.a].ga += hScore;
        if (hScore > aScore) {
            if (isOT) { results[g.h].otw++; results[g.h].p += 2; results[g.a].otl++; results[g.a].p += 1; }
            else { results[g.h].w++; results[g.h].p += 3; results[g.a].l++; }
        } else if (aScore > hScore) {
            if (isOT) { results[g.a].otw++; results[g.a].p += 2; results[g.h].otl++; results[g.h].p += 1; }
            else { results[g.a].w++; results[g.a].p += 3; results[g.h].l++; }
        }
    });
    const container = document.getElementById('standings-tables-container');
    if (!container) return;
    container.innerHTML = '';
    ['A', 'B', 'C'].forEach(grp => {
        let teams = Object.keys(teamGroups).filter(t => teamGroups[t] === grp);
        teams = sortTeamsWithTiebreaker(teams, results, prelims, storedScores);
        let html = `<table class="std-table"><colgroup><col class="c-num"><col class="c-team"><col class="c-gp"><col class="c-w"><col class="c-otw"><col class="c-otl"><col class="c-l"><col class="c-gf"><col class="c-ga"><col class="c-gd"><col class="c-pts"></colgroup><thead><tr><th class="th-${grp}" colspan="11">GROUP ${grp}</th></tr><tr><th>#</th><th style="text-align:left; padding-left:4px;">Team</th><th>GP</th><th>W</th><th>OTW</th><th>OTL</th><th>L</th><th>GF</th><th>GA</th><th>GD</th><th>PTS</th></tr></thead><tbody>`;
        teams.forEach((t, idx) => {
            const r = results[t];
            const gamesPlayed = r.w + r.otw + r.otl + r.l;
            const rank = idx + 1;
            html += `<tr><td>${rank}</td><td style="text-align:left; padding-left:4px;"><img src="https://flagcdn.com/w20/${flagMap[t]}.png" class="flag-icon" style="vertical-align:middle; margin-right:4px;">${t}</td><td>${gamesPlayed}</td><td>${r.w}</td><td>${r.otw}</td><td>${r.otl}</td><td>${r.l}</td><td>${r.gf}</td><td>${r.ga}</td><td>${r.gf - r.ga}</td><td>${r.p}</td></tr>`;
        });
        container.innerHTML += html + `</tbody></table>`;
    });
    
    // Update seeds 1-12
    updateSeeds(results, flagMap, teamGroups);
}

function updateSeeds(results, flagMap, teamGroups) {
    const data = window.HockeyData || {};
    const knockouts = data.knockouts || [];
    const prelims = data.prelims || [];
    const storedScores = Object.assign({}, data.storedScores || {}, storedScoresLocal);
    
    // Get all teams sorted by Olympic seeding rules
    // 1. Group standings using tiebreaker logic
    const groupStandings = {};
    ['A', 'B', 'C'].forEach(grp => {
        const teamsInGrp = Object.keys(teamGroups).filter(t => teamGroups[t] === grp);
        groupStandings[grp] = sortTeamsWithTiebreaker(teamsInGrp, results, prelims, storedScores).map(t => ({
            name: t,
            ...results[t],
            gd: results[t].gf - results[t].ga
        }));
    });
    
    // 2. Seeds 1-3: Group winners sorted by pts/GD/GF
    const groupWinners = [
        groupStandings['A'][0],
        groupStandings['B'][0],
        groupStandings['C'][0]
    ];
    groupWinners.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // 3. Seeds 4-6: Group runners-up (tiered by position, then pts/GD/GF)
    const secondPlace = [
        groupStandings['A'][1],
        groupStandings['B'][1],
        groupStandings['C'][1]
    ];
    secondPlace.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // 4. Seeds 7-9: Group third-place teams sorted by pts/GD/GF
    const thirdPlace = [
        groupStandings['A'][2],
        groupStandings['B'][2],
        groupStandings['C'][2]
    ];
    thirdPlace.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // 5. Seeds 10-12: Group fourth-place teams sorted by pts/GD/GF
    const fourthPlace = [
        groupStandings['A'][3],
        groupStandings['B'][3],
        groupStandings['C'][3]
    ];
    fourthPlace.sort((a,b) => b.p - a.p || b.gd - a.gd || b.gf - a.gf);
    
    // Combine all seeds in user-specified order
    const allTeams = [
        groupStandings['A'][0], // Canada
        groupStandings['C'][0], // USA
        groupStandings['B'][0], // Slovakia
        groupStandings['B'][1], // Finland
        groupStandings['A'][1], // Switzerland
        groupStandings['C'][1], // Germany
        groupStandings['B'][2], // Sweden
        groupStandings['A'][2], // Czechia
        groupStandings['C'][2], // Denmark
        groupStandings['C'][3], // Latvia
        groupStandings['A'][3], // France
        groupStandings['B'][3]  // Italy
    ];
    
    // Populate seeds 1-12 (only on seeding page)
    const seedingPage = document.getElementById('page-p9');
    if (seedingPage) {
        const seedRows = seedingPage.querySelectorAll('.seed-row');
        for (let i = 0; i < seedRows.length && i < allTeams.length; i++) {
            const team = allTeams[i];
            const row = seedRows[i];
            const nameEl = row.querySelector('.seed-name');
            const grpEl = row.querySelector('.seed-grp');
            const recEl = row.querySelector('.seed-record');
            const statEls = row.querySelectorAll('.seed-stat');
            
            // Build flag image
            const flagCode = flagMap[team.name];
            const flagImg = flagCode ? '<img src="https://flagcdn.com/w20/' + flagCode + '.png" class="flag-icon" style="vertical-align:middle;">' : '';
            
            // Set team name with flag for all seeds
            if (nameEl) {
                if (i < 4) {
                    nameEl.innerHTML = flagImg + '<span class="seed-name-nudge">' + team.name + '</span>';
                    // ensure flags stay in place and name nudged only
                    nameEl.style.display = 'flex';
                    nameEl.style.alignItems = 'center';
                } else {
                    // For seeds 5-12, flag left-aligned, name center
                    nameEl.innerHTML = '<span style="display:inline-block; width:18px; text-align:left;">' + flagImg + '</span><span style="flex:1; text-align:center;">' + team.name.substring(0,3).toUpperCase() + '</span>';
                    nameEl.style.display = 'flex';
                    nameEl.style.alignItems = 'center';
                    nameEl.style.justifyContent = 'center';
                }
            }
            
            // For top 4 seeds (i = 0-3), show group, GP and record
            if (i < 4 && grpEl && recEl) {
                const grp = teamGroups[team.name];
                grpEl.textContent = grp || '';
                grpEl.style.color = getGrpColor(grp);
                const gpEl = row.querySelector('.seed-gp');
                if (gpEl) gpEl.textContent = team.w + team.otw + team.otl + team.l;
                // apply high-specificity classes so transforms aren't overridden
                grpEl.classList.add('seed-nudge-grp');
                if (gpEl) gpEl.classList.add('seed-nudge-gp');
                recEl.classList.add('seed-nudge-rec');
                recEl.textContent = team.w + '-' + team.otw + '-' + team.otl + '-' + team.l;
            } else {
                // ensure classes removed for non-top seeds
                if (grpEl) grpEl.classList.remove('seed-nudge-grp');
                const gpEl = row.querySelector('.seed-gp');
                if (gpEl) gpEl.classList.remove('seed-nudge-gp');
                if (recEl) recEl.classList.remove('seed-nudge-rec');
            }
            
            // For seeds 5-12, show GP
            if (i >= 4) {
                const gpEl = row.querySelector('.seed-gp');
                if (gpEl) gpEl.textContent = team.w + team.otw + team.otl + team.l;
            }
            
            // For all seeds, show GD and Pts
            if (statEls.length >= 2) {
                statEls[0].textContent = team.gd;
                statEls[1].textContent = team.p;
                // nudge GD and PTS for top 4 seeds to the right using classes
                if (i < 4) {
                    statEls[0].classList.add('seed-nudge-gd');
                    statEls[1].classList.add('seed-nudge-pts');
                } else {
                    statEls[0].classList.remove('seed-nudge-gd');
                    statEls[1].classList.remove('seed-nudge-pts');
                }
            }
        }
    }
    
    // Update qualification games with actual team names
    const qualGames = document.getElementById('qual-games-v');
    if (qualGames) {
        qualGames.innerHTML = '';
        knockouts.filter(g => g.g === 'Q').forEach(g => {
            // Replace Seed X with actual team names
            let homeName = g.h;
            let awayName = g.a;
            let homeFlag = '';
            let awayFlag = '';
            
            if (homeName.startsWith('Seed ')) {
                const seedNum = parseInt(homeName.replace('Seed ', ''));
                if (allTeams[seedNum - 1]) {
                    homeName = allTeams[seedNum - 1].name;
                    homeFlag = flagMap[homeName];
                }
            } else {
                homeFlag = flagMap[homeName] || '';
            }
            if (awayName.startsWith('Seed ')) {
                const seedNum = parseInt(awayName.replace('Seed ', ''));
                if (allTeams[seedNum - 1]) {
                    awayName = allTeams[seedNum - 1].name;
                    awayFlag = flagMap[awayName];
                }
            } else {
                awayFlag = flagMap[awayName] || '';
            }
            
            const tr = document.createElement('tr');
            tr.innerHTML = '<td class="c-grp" style="padding:6px 4px; text-align:center; width:18px;">' + g.g + '</td>' +
                '<td class="c-ven" style="padding:6px 4px; text-align:center; width:18px;">' + g.v + '</td>' +
                '<td class="c-date" style="padding:6px 4px; text-align:center; width:68px;">' + g.d + '</td>' +
                '<td class="c-time" style="padding:6px 4px; text-align:center; width:42px;">' + g.t + '</td>' +
                '<td class="c-flag" style="padding:6px 6px 6px 8px; text-align:right; width:22px;">' +
                    (homeFlag ? '<img src="https://flagcdn.com/w20/' + homeFlag + '.png" class="flag-icon" style="vertical-align:middle;">' : '') +
                '</td>' +
                '<td class="c-match" style="padding:6px 4px; text-align:center;">' +
                    '<span style="display:inline-block; min-width:76px; text-align:right; padding-right:4px;">' + homeName + '</span>' +
                    '<span class="score-area" style="display:inline-block; width:36px;">' +
                        '<span class="sb">' + (storedScores[g.id + '-h'] || '') + '</span>' +
                        '<span class="sb">' + (storedScores[g.id + '-a'] || '') + '</span>' +
                    '</span>' +
                    '<span style="display:inline-block; min-width:76px; text-align:left; padding-left:4px;">' + awayName + '</span>' +
                '</td>' +
                '<td class="c-flag" style="padding:6px 2px 6px 3px; text-align:left; width:22px;">' +
                    (awayFlag ? '<img src="https://flagcdn.com/w20/' + awayFlag + '.png" class="flag-icon" style="vertical-align:middle;">' : '') +
                '</td>';
            qualGames.appendChild(tr);
        });
        
        // Display-only: no handlers needed
    }
}

// Display-only version - no editing allowed
window.handleInput = function(el, key) {
    // Disabled in clean version
};

// Display-only: no sync indicator needed
function showSync() {
    // Disabled in clean version
}

// Display-only version - no save functions needed
window.masterSave = function() {
    alert('This is the clean display version. Update data.json on the server to change scores.');
};
window.exportDataJSON = function() {
    alert('This is the clean display version. No export needed.');
};
window.saveUpdatedHTML = function() {
    alert('This is the clean display version. No export needed.');
};

// Display-only version - no API calls needed



// Display-only version - no API calls
window.refreshScores = function() {
    alert('This is the clean display version. Update data.json on the server to change scores.');
};

function updateScoringTableData(scorers) {
    const tbody = document.querySelector('#page-p_new8 table tbody');
    if (!tbody) {
        console.error('Could not find scoring table tbody');
        return;
    }
    
    console.log('Updating scoring table with', scorers.length, 'scorers');
    
    const teamToCountry = {
        'CAN': 'ca', 'USA': 'us', 'SWE': 'se', 'FIN': 'fi',
        'SVK': 'sk', 'CZE': 'cz', 'SWI': 'ch', 'GER': 'de',
        'LAT': 'lv', 'DEN': 'dk', 'ITA': 'it', 'FRA': 'fr'
    };
    
    let html = '';
    scorers.forEach((s, idx) => {
        const flag = teamToCountry[s.team] || 'ca';
        const rankNum = s.rank.replace('.', '');
        html += `<tr style="background:#fff;">
            <td style="padding:3px; text-align:center; font-size:11px;">${rankNum}</td>
            <td style="padding:3px 0 3px 5px; font-weight:700; font-size:13px;">
                <img src='https://flagcdn.com/w20/${flag}.png' style='width:18px; height:12px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:4px;'> ${s.name}
            </td>
            <td style="padding:3px; font-size:12px; text-align:center;">${s.team}</td>
            <td style="padding:3px; text-align:center;">${s.gp}</td>
            <td style="padding:3px; text-align:center;">${s.goals}</td>
            <td style="padding:3px; text-align:center;">${s.assists}</td>
            <td style="padding:3px; text-align:center; font-weight:bold;">${s.points}</td>
        </tr>`;
    });
    
    tbody.innerHTML = html;
    console.log('Scoring table updated successfully');
}

function updateGoalieTableData(goalies) {
    const tables = document.querySelectorAll('#page-p_new8 table');
    if (tables.length < 2) {
        console.error('Could not find goalie table - only found', tables.length, 'tables');
        return;
    }
    
    const tbody = tables[1].querySelector('tbody');
    if (!tbody) {
        console.error('Could not find goalie table tbody');
        return;
    }
    
    console.log('Updating goalie table with', goalies.length, 'goalies');
    
    const teamToCountry = {
        'CAN': 'ca', 'USA': 'us', 'SWE': 'se', 'FIN': 'fi',
        'SVK': 'sk', 'CZE': 'cz', 'SWI': 'ch', 'GER': 'de',
        'LAT': 'lv', 'DEN': 'dk', 'ITA': 'it', 'FRA': 'fr'
    };
    
    let html = '';
    goalies.forEach((g, idx) => {
        const flag = teamToCountry[g.team] || 'ca';
        const rankNum = g.rank.replace('.', '');
        html += `<tr style="background:#fff;">
            <td style="padding:3px; text-align:center; font-size:11px;">${rankNum}</td>
            <td style="padding:3px 0 3px 5px; font-weight:700; font-size:13px;">
                <img src='https://flagcdn.com/w20/${flag}.png' style='width:18px; height:12px; border-radius:2px; border:1px solid #ccc; vertical-align:-1px; margin-right:4px;'> ${g.name}
            </td>
            <td style="padding:3px; font-size:12px; text-align:center;">${g.team}</td>
            <td style="padding:3px; text-align:center;">${g.gp}</td>
            <td style="padding:3px; text-align:center;">${g.wins}</td>
            <td style="padding:3px; text-align:center;">${g.gaa}</td>
            <td style="padding:3px; text-align:center;">${g.svp}</td>
        </tr>`;
    });
    
    tbody.innerHTML = html;
    console.log('Goalie table updated successfully');
}

// Initialize on page load (display-only mode)
document.addEventListener('DOMContentLoaded', () => {
    // Initialize tables from embedded HockeyData
    injectTables();
    updateStandings();
    
    // Load cached ESPN stats from HockeyData.storedESPNStats
    const data = window.HockeyData || {};
    const cached = data.storedESPNStats || {};
    
    if (cached.scorers && cached.scorers.length > 0) {
        console.log('Loading cached scorers:', cached.scorers);
        updateScoringTableData(cached.scorers);
    }
    
    if (cached.goalies && cached.goalies.length > 0) {
        console.log('Loading cached goalies:', cached.goalies);
        updateGoalieTableData(cached.goalies);
    }
});
</script>

</body>
</html>
